.\" Copyright (c) 1985, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Japanese Version Copyright (c) 2005 Takashi Nishida
.\"         all rights reserved.
.\" Translated Sat Sat Sep 24 15:51:25 JST 2005 (ver0.03)
.\"         by Takashi Nishida
.\"
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	$Id: restore.8.in,v 1.30 2003/03/30 15:40:39 stelian Exp $
.\"
.TH RESTORE 8 "version 0.4b34 of April 18, 2003" BSD "System management commands"
.\"O.SH NAME
.SH 名前
restore \- dumpで作ったバックアップからファイルもしくはファイルシステムを修復する。
.SH 書式
.B restore \-C 
[\fB\-cdklMvVy\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-D \fIfilesystem\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-L \fIlimit\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
.PP
.B restore \-i
[\fB\-acdhklmMNouvVy\fR]
[\fB\-A \fIfile\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-Q \fIfile\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
.PP
.B restore \-P 
.I file
[\fB\-acdhklmMNuvVy\fR]
[\fB\-A \fIfile\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
[\fB\-X \fIfilelist\fR]
[ \fIfile ... \fR]
.PP
.B restore \-R
[\fB\-cdklMNuvVy\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
.PP
.B restore \-r 
[\fB\-cdklMNuvVy\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
.PP
.B restore \-t
[\fB\-cdhklMNuvVy\fR]
[\fB\-A \fIfile\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-Q \fIfile\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
[\fB\-X \fIfilelist\fR]
[ \fIfile ... \fR]
.PP
.B restore \-x 
[\fB\-adchklmMNouvVy\fR]
[\fB\-A \fIfile\fR]
[\fB\-b \fIblocksize\fR]
[\fB\-f \fIfile\fR]
[\fB\-F \fIscript\fR]
[\fB\-Q \fIfile\fR]
[\fB\-s \fIfileno\fR]
[\fB\-T \fIdirectory\fR]
[\fB\-X \fIfilelist\fR]
[ \fIfile ... \fR]
.PP
.\"O (The 4.3BSD option syntax is implemented for backward compatibility but is not 
.\"O documented here.)
(過去との互換性のために4.3BSDのオプション文法が実装されているが、
ここでは文書化されない)
.\"O .SH DESCRIPTION
.SH 説明
.\"O The
.\"O .B restore
.\"O command performs the inverse function of
.\"O .BR dump (8).
.B restore
コマンドは
.BR dump (8)
の逆の機能を実行する。
.\"O A full backup of a file system may be restored and subsequent incremental
.\"O backups layered on top of it. Single files and directory subtrees may be 
.\"O restored from full or partial backups.
ファイルシステムのフルバックアップが復元され、
続く増分バックアップ(incremental backups)がその上に積み重ねられる。
個々のファイルやディレクトリサブツリーがフルバックアップもしくは部分バックアップから復元できる。
.\"O .B Restore
.\"O works across a network; to do this see the
.\"O .B \-f
.\"O flag described below. Other arguments to the command are file or directory
.\"O names specifying the files that are to be restored. Unless the
.\"O .B \-h
.\"O flag is specified (see below), the appearance of a directory name refers to
.\"O the files and (recursively) subdirectories of that directory.
.B Restore
はネットワークを越えて動作する; 
これをするためには
以下に記述する
.B \-f
フラグを見ること。
コマンドへの他の引数はファイルもしくはディレクトリで、
復元するファイルを明示する。
.B \-h
フラグ(下記)が明示されない限り、
ディレクトリ名を示すと
そのディレクトリのファイルやサブディレクトリ(再帰的に)を参照する。
.PP
.\"O .PP
.\"O Exactly one of the following flags is required:
.\"O .TP
以下のフラグのうち必ず一つが必要である:
.TP
.\"O .B \-C
.\"O This mode allows comparison of files from a dump.
.\"O .B Restore
.\"O reads the backup and compares its contents with files present on the disk. It
.\"O first changes its working directory to the root of the filesystem that was 
.\"O dumped and compares the tape with the files in its new current directory. See
.\"O also the
.B \-C
このモードではダンプとファイルの比較をする。
.B restore
はバックアップを読んでその内容をディスク上にあるファイルと比較する。
まず、ワーキングディレクトリをダンプしたファイルシステムのルートに変更し、
テープと新しいカレントディレクトリのファイルと比較する。
後述の
.\"O .B \-L
フラグも参照せよ。
.\"O .TP
.\"O .B \-i
.\"O This mode allows interactive restoration of files from a dump. After reading in
.\"O the directory information from the dump,
.\"O .B restore
.\"O provides a shell like interface that allows the user to move around the 
.\"O directory tree selecting files to be extracted. The available commands are 
.\"O given below; for those commands that require an argument, the default is the
.\"O current directory.
.\"O .RS
.TP
.B \-i
このモードはダンプからのファイルの対話的な復旧ができる。
ダンプからディレクトリ情報を読んだ後、
.B restore
はシェルのようなインターフェースを提供し、
ユーザーはディレクトリツリーを動きまわることができ、展開すべきファイルを選ぶ。
利用できるコマンドは以下に示す;
引数を必要とするコマンドでは、
デフォルトはカレントディレクトリである。
.RS
.\"O .TP
.\"O .B add \fR[\fIarg\fR]
.\"O The current directory or specified argument is added to the list of files to be
.\"O extracted.  If a directory is specified, then it and all its descendents are
.\"O added to the extraction list (unless the
.\"O .B \-h
.\"O flag is specified on the command line). Files that are on the extraction list
.\"O are prepended with a \*(lq*\*(rq when they are listed by 
.\"O .BR ls .
.\"O .TP
.\"O .BI cd " arg"
.\"O Change the current working directory to the specified argument.
.TP
.B add \fR[\fIarg\fR]
カレントディレクトリもしくは指定の引数を展開するファイルのリストに加える。
もし、ディレクトリが指定された場合は、それ以下を展開リストに加える。
(コマンドラインで
.B \-h
フラグが無い限り)。
.BR ls
でリストすると、
展開リストにあるファイルは
\*(lq*\*(rqが前に付け加えられる。
.TP
.BI cd " arg"
カレントワーキングディレクトリを指定された引数に変更する。
.\"O .TP
.\"O .B delete \fR[\fIarg\fR]
.\"O The current directory or specified argument is deleted from the list of files 
.\"O to be extracted. If a directory is specified, then it and all its descendents
.\"O are deleted from the extraction list (unless the
.\"O .B \-h
.\"O flag is specified on the command line). The most expedient way to extract most 
.\"O of the files from a directory is to add the directory to the extraction list
.\"O and then delete those files that are not needed.
.TP
.B delete \fR[\fIarg\fR]
カレントディレクトリもしくは指定の引数を
展開するファイルのリストから削除する。
もし、ディレクトリが指定されたら、それ以下が
展開リストから削除される。
(コマンドラインで
.B \-h
フラグが指定されていない限り)。
ディレクトリから多くのファイルを展開する
もっとも好都合な方法は、
ディレクトリを展開リストに加えて、そして、必要でないファイルを削除することである。
.\"O .TP
.\"O .B extract
.\"O All files on the extraction list are extracted from the dump.
.\"O .B Restore
.\"O will ask which volume the user wishes to mount. The fastest way to extract a f
.\"O ew files is to start with the last volume and work towards the first volume.
.TP
.B extract
展開リストの全てのファイルをダンプから展開する。
.B restore
はユーザーがマウントしたいボリュームを聞いて来る。
わずかなファイルを最も速く展開する方法は、
最後のボリュームからはじめて、最初のボリュームに戻って行くことである。
.\"O .TP
.\"O .B help
.\"O List a summary of the available commands.
.TP
.B help
利用可能なコマンドのまとめを列挙する。
.\"O .TP
.\"O .B ls \fR[\fIarg\fR]
.\"O List the current or specified directory. Entries that are directories are 
.\"O appended with a \*(lq/\*(rq. Entries that have been marked for extraction are 
.\"O prepended with a \*(lq*\*(rq. If the verbose flag is set, the inode number of 
.\"O each entry is also listed.
.TP
.B ls \fR[\fIarg\fR]
カレントもしくは指定したディレクトリを表示する。
ディレクトリのエントリは
\*(lq/\*(rq
が付加される。
展開のためにマークをつけたエントリは
前に\*(lq*\*(rqが着いている。
もし、verbose フラグをつけた場合は、
各エントリのinode番号もリストする。
.\"O .TP
.\"O .B pwd
.\"O Print the full pathname of the current working directory.
.TP
.B pwd
カレントワーキングディレクトリのフルパス名を表示する。
.\"O .TP
.\"O .B quit
.\"O .B Restore
.\"O immediately exits, even if the extraction list is not empty.
.TP
.B quit
展開リストが空でなくても、
.B restore
は直ちに終了する。
.\"O .TP
.\"O .B setmodes
.\"O All directories that have been added to the extraction list have their owner, 
.\"O modes, and times set; nothing is extracted from the dump. This is useful for 
.\"O cleaning up after a 
.\"O .B restore 
.\"O has been prematurely aborted.
.TP
.B setmodes
展開リストに加えられている全てのディレクトリにオーナー、モード、そして時間をセットするだけで、
ダンプからは展開しない。
これは、
.B restore 
を打ち切った後で、後かたづけするのに便利である。
.\"O .TP
.\"O .B verbose
.\"O The sense of the 
.\"O .B \-v
.\"O flag is toggled. When set, the verbose flag causes the 
.\"O .B ls
.\"O command to list the inode numbers of all entries. It also causes
.\"O .B restore
.\"O to print out information about each file as it is extracted.
.TP
.B verbose
.B \-v
フラグの状態を入切する。
セットされると、
verboseフラグは
.B ls
コマンドで、
全てのエントリにinode番号を記載するようにする。
また、
.B restore
は
各ファイルが展開されるか
情報を表示する。
.\"O .RE
.RE
.\"O .TP
.\"O .BI \-P " file"
.\"O .B Restore
.\"O creates a new Quick File Access file 
.\"O .I file
.\"O from an existing dump file without restoring its contents.
.TP
.BI \-P " file"
今あるダンプファイルから
内容をリストアすること無しに
新しいQuick File Access ファイル
.I file
を生成する。
.\"O .TP
.\"O .B \-R
.\"O .B Restore
.\"O requests a particular tape of a multi-volume set on which to restart a full 
.\"O restore (see the
.\"O .B \-r
.\"O flag below). This is useful if the restore has been interrupted.
.TP
.B \-R
フルリストア(
(下記の
.B \-r
フラグを見よ)
を再開する場合に、
.B restore
はマルチボリューム一式のうちの一部のテープを要求する。
restoreを中断した場合にこれは便利である。
.\"O .TP
.\"O .B \-r
.\"O Restore (rebuild) a file system. The target file system should be made pristine
.\"O with
.\"O .BR mke2fs (8),
.\"O mounted, and the user
.\"O .BR cd 'd
.\"O into the pristine file system before starting the restoration of the initial
.\"O level 0 backup. If the level 0 restores successfully, the
.\"O .B \-r
.\"O flag may be used to restore any necessary incremental backups on top of the
.\"O level 0. The
.\"O .B \-r
.\"O flag precludes an interactive file extraction and can be detrimental to one's 
.\"O health (not to mention the disk) if not used carefully. An example:
.\"O .IP
.TP
.B \-r
ファイルシステムをリストア(再構築)する。
level 0バックアップの復旧を最初にはじめる前に、
ターゲットファイルシステムを
.BR mke2fs (8)
で初期化、マウントし、初期化したファイルシステムに
.BR cd
で移動していなくてはならない。
もし、level 0 がうまくリストアできたら、
level 0 を頂点とした
任意の増分バックアップが
.B \-r
フラグを使ってリストアできる。
不注意に利用すると、
.B \-r
フラグでは対話的なファイル展開をしないので
うっかりリストアをしてしまうと差障りがあるだろう。
(ディスクだけではなく)
例えば:
.IP
.\"O .RS 14
.\"O .B mke2fs /dev/sda1
.\"O .TP
.\"O .B mount /dev/sda1 /mnt
.\"O .TP
.\"O .B cd /mnt
.\"O .TP
.\"O .B restore rf /dev/st0
.\"O .RE
.RS 14
.B mke2fs /dev/sda1
.TP
.B mount /dev/sda1 /mnt
.TP
.B cd /mnt
.TP
.B restore rf /dev/st0
.RE
.\"O .IP
.\"O Note that 
.\"O .B restore
.\"O leaves a file 
.\"O .I restoresymtable
.\"O in the root directory to pass information between incremental restore passes.
.\"O This file should be removed when the last incremental has been restored.
.\"O .IP
.\"O .BR Restore ,
.\"O in conjunction with
.\"O .BR mke2fs (8)
.\"O and
.\"O .BR dump (8),
.\"O may be used to modify file system parameters such as size or block size.
.IP
.B restore
は増分リストア各パスの間の情報を渡すために
ファイル
.I restoresymtable
をルートディレクトリに置くことに注意せよ。
最後の増分がリストアできたら
このファイルは取り除くべきである。
.IP
.BR mke2fs (8)
および
.BR dump (8)
と組み合わせて
.BR restore 
は
サイズやブロックサイズのような
ファイルシステムパラメータを変更するのに
用いることができる。
.\"O .TP
.\"O .B \-t
.\"O The names of the specified files are listed if they occur on the backup. If no 
.\"O file argument is given, the root directory is listed, which results in the
.\"O entire content of the backup being listed, unless the
.\"O .B \-h
.\"O flag has been specified.  Note that the
.\"O .B \-t
.\"O flag replaces the function of the old
.\"O .BR dumpdir (8)
.\"O program.  See also the
.\"O .B \-X
.\"O option below.
.TP
.B \-t
指定ファイルがバックアップにあるならその名前を表示する。
もし、ファイル引数を与えなかった場合は、ルートディレクトリが表示され、
.B \-h
フラグを指定しない限り、
バックアップの全内容が表示される結果になる。
.B \-t
フラグは
古い
.BR dumpdir (8)
プログラムの機能を置き換えるものであることに
注意されたい。
以下の
.B \-X
オプションも見よ。
.\"O .TP
.\"O .B \-x
.\"O The named files are read from the given media. If a named file matches a 
.\"O directory whose contents are on the backup and the
.\"O .B \-h
.\"O flag is not specified, the directory is recursively extracted. The owner, 
.\"O modification time, and mode are restored (if possible). If no file argument is
.\"O given, the root directory is extracted, which results in the entire content of
.\"O the backup being extracted, unless the
.\"O .B \-h
.\"O flag has been specified.  See also the
.\"O .B \-X
.\"O option below.
.\"O .SH OPTIONS
.\"O The following additional options may be specified:
.TP
.B \-x
与えられたメディアから指定ファイルを読む。
もし、
指定ファイルがディレクトリで
バックアップ上にはその中身があって
.B \-h
フラグが指定されていない場合、
ディレクトリは再帰的に展開される。
オーナー、修正時間、そしてモードがリストアされる(可能ならば)。
もし、ファイル引数がなにも与えられない場合、
ルートディレクトリが展開され、
.B \-h
フラグが指定されない限り、
バックアップのすべての内容が展開される結果になる。
また、以下の
.B \-X
オプションも見ること。

.SH オプション
以下の追加オプションが指定できる:
.\"O .TP
.\"O .B \-a
.\"O In 
.\"O .B \-i
.\"O or
.\"O .B \-x
.\"O mode, 
.\"O .B restore 
.\"O does ask the user for the volume number on which the files to be extracted are 
.\"O supposed to be (in order to minimise the time by reading only the interesting 
.\"O volumes). The 
.\"O .B \-a
.\"O option disables this behaviour and reads all the volumes starting with 1. This 
.\"O option is useful when the operator does not know on which volume the files to 
.\"O be extracted are and/or when he prefers the longer unattended mode rather than
.\"O the shorter interactive mode.
.TP
.B \-a
.B \-i
もしくは
.B \-x
モードでは、
.B restore 
は展開したいファイルがはいっているボリューム番号を
ユーザーに要求する。
(時間を最小限にするため必要なボリュームだけ読みこむ)
.B \-a
オプションはこの機能を無効にし、1からはじまる全てのボリュームを読む。
展開したにファイルがどのボリュームにあるかオペレータが知らない場合、
短時間い対話式モードよりもむしろ長くても無人モードの方が好ましい場合、
このオプションが役立つ。
.TP
.BI \-A " archive_file"
メディアの代わりに
.I archive_file
から内容一覧を読み込む。
このオプションは
.BR \-t ,
.BR \-i ,
もしくは
.B \-x 
オプションと組み合わせて使え、
メディアをマウントすることなしにメディア上にファイルが存在するかどうか
調べることを可能にする。
.\"O .TP
.\"O .BI \-A " archive_file"
.\"O Read the table of contents from
.\"O .I archive_file
.\"O instead of the media. This option can be used in combination with the 
.\"O .BR \-t ,
.\"O .BR \-i ,
.\"O or 
.\"O .B \-x 
.\"O options, making it possible to check whether files are on the media without 
.\"O having to mount the media.
.TP
.BI \-b " blocksize"
ダンプレコードあたりのkilobytes数。
もし、
.B \-b
オプションを指定しない場合、
.B restore
はメディアブロックサイズを動的に決定しようとする。
.\"O .TP
.\"O .BI \-b " blocksize"
.\"O The number of kilobytes per dump record. If the
.\"O .B \-b
.\"O option is not specified,
.\"O .B restore
.\"O tries to determine the media block size dynamically.
.\"O .TP
.\"O .B \-c
.\"O Normally,
.\"O .B restore
.\"O will try to determine dynamically whether the dump was made from an old 
.\"O (pre-4.4) or new format file system. The
.\"O .B \-c
.\"O flag disables this check, and only allows reading a dump in the old format.
.TP
.B \-c
通常、
.B restore
は起動時にダンプが古いファイル形式(pre-4.4)か新しいファイル形式
のどちらで生成されたかを判断しようとする。
.B \-c
はこの検査を無効にし、ダンプを旧フォーマットで読むことだけを許可する。
.\"O .TP
.\"O .B \-d
.\"O The
.\"O .B \-d
.\"O (debug) flag causes
.\"O .B restore
.\"O to print debug information.
.TP
.B \-d
.B \-d
(デバッグ)フラグは
.B restore
がデバッグ情報を表示するようにする。
.\"O .TP
.\"O .BI \-D " filesystem"
.\"O The
.\"O .B \-D
.\"O flag allows the user to specify the filesystem name when using
.\"O .B restore
.\"O with the
.\"O .B \-C
.\"O option to check the backup.
.TP
.BI \-D " filesystem"
.B restore
を
.B \-C
オプションで使って
バックアップを検査する際に
ユーザーは
.B \-D
フラグでファイルシステム名を指定することができる。
.\"O .TP
.\"O .BI \-f " file"
.\"O Read the backup from
.\"O .IR file ;
.\"O .I file
.\"O may be a special device file like
.\"O .I /dev/st0
.\"O (a tape drive),
.\"O .I /dev/sda1
.\"O (a disk drive), an ordinary file, or
.\"O .I \-
.\"O (the standard input). If the name of the file is of the form
.\"O .I host:file 
.\"O or
.\"O .IR user@host:file ,
.\"O .B restore
.\"O reads from the named file on the remote host using
.\"O .BR rmt (8).
.TP
.BI \-f " file"
バックアップを
.IR file 
から読む ;
.I file
は
.I /dev/st0
(テープドライブ),
.I /dev/sda1
(ディスクドライブ)
のようなデバイスファイル、
通常のファイル,
もしくは
.I \-
(標準入力)
である。
もし、ファイル名が
.I host:file 
もしくは
.IR user@host:file
の形式であるなら、
.B restore
は
.BR rmt (8)
を使ってリモートホスト上の指定ファイルから読み込む。
.\"O .TP
.\"O .BI \-F " script"
.\"O Run script at the beginning of each tape. The device name and the current 
.\"O volume number are passed on the command line. The script must return 0 if 
.\"O .B restore
.\"O should continue without asking the user to change the tape, 1 if 
.\"O .B restore
.\"O should continue but ask the user to change the tape. Any other exit code will 
.\"O cause
.\"O .B restore
.\"O to abort. For security reasons,
.\"O .B restore
.\"O reverts back to the real user ID and the real group ID before running the 
.\"O script.
.TP
.BI \-F " script"
各テープのはじめでスクリプト(script)を走らせる。
デバイス名と現在のボリューム番号がコマンドライン引数で渡される。 
もし、
.B restore
がテープを交換するようにユーザーに要求せずに続けたいなら、
スクリプトは必ず0を返す必要があり、
続けるけれどもユーザーにテープを交換するように要求するのなら1を返す。
他の終了コードでは
.B restore
を中止させる。
セキュリティ上の理由で、
スクリプトを走らせる前に
.B restore
は本来(real)のユーザーIDとグループIDに戻る。
.\"O .TP
.\"O .B \-h
.\"O Extract the actual directory, rather than the files that it references. This 
.\"O prevents hierarchical restoration of complete subtrees from the dump.
.TP
.B \-h
ディレクトリを抽出し、
その中のファイルは抽出しない。
これで、
ダンプからサブツリー全体の階層的なリストアを抑制する。
.\"O .TP
.\"O .B \-k
.\"O Use Kerberos authentication when contacting the remote tape server. (Only 
.\"O available if this options was enabled when
.\"O .B restore
.\"O was compiled.)
.TP
.B \-k
リモートテープサーバーと通信する時にKerbelos認証を使う。
(
.B restore
をコンパイルするときに
このオプションが有効にされている場合のみ利用可能
)
.\"O .TP
.\"O .B \-l
.\"O When doing remote restores, assume the remote file is a regular file (instead
.\"O of a tape device). If you're restoring a remote compressed file, you will need
.\"O to specify this option or 
.\"O .B restore
.\"O will fail to access it correctly.
.TP
.B \-l
リモートリストアをするときに、
リモートファイルは
(テープデバイスではなく)
通常のファイルであると仮定する。
もし、リモートの圧縮ファイルをリストアする場合は
このオプションを指定する必要があり、
そうしないと
.B restore
は正しくアクセスできない。
.\"O .TP
.\"O .BI \-L " limit"
.\"O The
.\"O .B \-L
.\"O flag allows the user to specify a maximal number of miscompares when using
.\"O .B restore
.\"O with the
.\"O .B \-C
.\"O option to check the backup. If this limit is reached, 
.\"O .B restore
.\"O will abort with an error message. A value of 0 (the default value) disables 
.\"O the check.
.TP
.BI \-L " limit"
バックアップを検査するのに
.B restore
を
.B \-C
オプションで
使うとき、
.B \-L
フラグで不一致の上限回数を指定できる。
もし、この制限に達っすると、
.B restore
はエラーメッセージとともに中断する。
0の値(デフォルト値)は検査を無効にする。
.\"O .TP
.\"O .B \-m
.\"O Extract by inode numbers rather than by file name. This is useful if only a few
.\"O files are being extracted, and one wants to avoid regenerating the complete 
.\"O pathname to the file.
.TP
.B \-m
は
ファイル名ではなくinode番号によって展開する。
これは、
展開すべきファイルはわずかばかりで、
ファイルの完全なパス名を生成するのを避けたいときに、
便利である。
.\"O .TP
.\"O .B \-M
.\"O Enables the multi-volume feature (for reading dumps made using the 
.\"O .B \-M
.\"O option of dump). The name specified with
.\"O .B \-f
.\"O is treated as a prefix and
.\"O .B restore
.\"O tries to read in sequence from 
.\"O .I <prefix>001, <prefix>002 
.\"O etc. 
.TP
.B \-M
はマルチボリューム機能を有効にする。
(dumpの
.B \-M
オプションを使って作ったダンプを読むために)
.B \-f
で指定された名前
はprefixとして扱われ、
.B restore
は
.I <prefix>001, <prefix>002 
他の順で読みこもうとする。
.\"O .TP
.\"O .B \-N
.\"O The
.\"O .B \-N
.\"O flag causes
.\"O .B restore
.\"O to perform a full execution as requested by one of
.\"O .BR \-i ,
.\"O .BR \-R ,
.\"O .BR \-r ,
.\"O .B t
.\"O or
.\"O .B x
.\"O command without actually writing any file on disk.
.TP
.B \-N
.B \-N
フラグは
.BR \-i ,
.BR \-R ,
.BR \-r ,
.B t
もしくは
.B x
コマンドのどれかで要請された全作業を、
ディスクにファイルを実際に書き込まずに、
.B restore
が実施するようにする。
.\"O .TP
.\"O .B \-o
.\"O The
.\"O .B \-o
.\"O flag causes
.\"O .B restore
.\"O to automatically restore the current directory permissions without asking the 
.\"O operator whether to do so in one of
.\"O .B \-i
.\"O or
.\"O .B \-x
.\"O modes.
.TP
.B \-o
.B \-i
もしくは
.B \-x
モードでオペレータに問い合わせること無く
.B restore
が現ディレクトリのパーミッションを
自動的に復元するようにする。
.\"O .TP
.\"O .BI \-Q " file"
.\"O Use the file
.\"O .I file
.\"O in order to read tape position as stored using the dump Quick File Access mode,
.\"O in one of 
.\"O .BR \-i ,
.\"O .B \-x
.\"O or
.\"O .B \-t
.\"O mode.
.TP
.BI \-Q " file"
は、
.BR \-i ,
.B \-x
もしくは
.B \-t
モードにおいて、
ファイル
.I file
をdumpの Quick File Accessモードを使って格納されているものとして
テープ位置を読みこむのに使う。
.\"O .IP
.\"O It is recommended to set up the st driver to return logical tape positions 
.\"O rather than physical before calling 
.\"O .B dump/restore
.\"O with parameter 
.\"O .BR \-Q .
.\"O Since not all tape devices support physical tape positions those tape devices 
.\"O return an error during
.\"O .B dump/restore
.\"O when the st driver is set to the default physical setting. Please see the
.\"O .BR st (4)
.\"O man page, option 
.\"O .B MTSETDRVBUFFER
.\"O , or the
.\"O .BR mt(1)
.\"O man page, on how to set the driver to return logical tape positions.
.IP
パラメータ
.BR \-Q .
で
.B dump/restore
を呼ぶ前に、
物理ではなく論理テープ位置を返すように
stドライバをセットアップしておくことを推奨する。
すべてのテープデバイスが
物理テープ位置をサポートしているわけではないので、
stドライバがデフォルトの物理位置の設定にセットされる時、
それらのテープデバイスは
.B dump/restore
の時にエラーを返す。
どのようにドライバを論理テープ位置を返すように設定するかについては、
.BR st (4)
man page 
オプション
.B MTSETDRVBUFFER
, もしくは
.BR mt(1)
man page
を見るように。
.\"O .IP
.\"O Before calling 
.\"O .B restore
.\"O with parameter 
.\"O .BR \-Q ,
.\"O always make sure the st driver is set to return the same type of tape position
.\"O used during the call to
.\"O .BR dump .
.\"O Otherwise
.\"O .B restore
.\"O may be confused.
.IP
.B restore
をパラメータ
.BR \-Q 
で呼ぶ前に、
.BR dump 
を呼んだときに使ったものと
同じ形式のテープ位置を返すように
stドライバが
設定されていることをいつも確かめるように。
そうでなければ、
.B restore
は混乱するであろう。
.\"O .IP
.\"O This option can be used when restoring from local or remote tapes (see above) 
.\"O or from local or remote files.
.IP
このオプションは
ローカルもしくはリモートテープ(上記を見ること)
もしくはローカル、リモートファイルから復元するときに、
使うことができる。
.\"O .TP
.\"O .BI \-s " fileno"
.\"O Read from the specified
.\"O .I fileno
.\"O on a multi-file tape. File numbering starts at 1.
.TP
.BI \-s " fileno"
マルチファイルテープの
指定された
.I fileno
から読む。
ファイル番号は1から開始する。
.\"O .TP
.\"O .BI \-T " directory"
.\"O The
.\"O .B \-T
.\"O flag allows the user to specify a directory to use for the storage of temporary
.\"O files. The default value is 
.\"O .IR /tmp .
.\"O This flag is most useful when restoring files after having booted from a 
.\"O floppy. There might be little or no space on the floppy filesystem, but another
.\"O source of space might exist.
.TP
.BI \-T " directory"
.B \-T
フラグで
テンポラリファイルを格納するのに使う
ディレクトリが指定できる。
デフォルト値は
.IR /tmp 
である。
このフラグは
フロッピーからブートした後でrestoreする時に
もっとも便利である。
フロッピーのファイルシステムでは
空きがないか、わずかなのに
他の資源には空きがあるであろうから。
.\"O .TP
.\"O .B \-u
.\"O When creating certain types of files, 
.\"O .B restore
.\"O may generate a warning diagnostic if they already exist in the target 
.\"O directory. To prevent this, the
.\"O .B \-u
.\"O (unlink) flag causes
.\"O .B restore
.\"O to remove old entries before attempting to create new ones.
.TP
.B \-u
ある種のファイルを生成するとき、
それらがターゲットディレクトリにすでに存在するなら
.B restore
は警告診断を発生させる。
これを防止するため、
.B \-u
(unlink) 
フラグで
.B restore
が新しいエントリを生成しようとする前に
古いエントリを削除する。
.\"O .TP
.\"O .B \-v
.\"O Normally
.\"O .B restore
.\"O does its work silently. The
.\"O .B \-v
.\"O (verbose) flag causes it to type the name of each file it treats preceded by 
.\"O its file type.
.TP
.B \-v
通常、
.B restore
は静かに稼働する。
.B \-v
(verbose) フラグは
ファイルを取り扱う前に
それぞれのファイルのタイプに続いて名前を表示する。
.\"O .TP
.\"O .B \-V
.\"O Enables reading multi-volume non-tape mediums like CDROMs.
.TP
.B \-V
は
CDROMのような非テープメディアの
マルチボリュームを読みだすことを有効にする。
.\"O .TP
.\"O .BI \-X " filelist"
.\"O Read list of files to be listed or extracted from the text file
.\"O .I filelist
.\"O in addition to those specified on the command line. This can be used in 
.\"O conjunction with the
.\"O .B \-t
.\"O or
.\"O .B \-x
.\"O commands. The file
.\"O .I filelist
.\"O should contain file names separated by newlines.
.\"O .I filelist
.\"O may be an ordinary file or
.\"O .I -
.\"O (the standard input).
.TP
.BI \-X " filelist"
は
テキストファイル
.I filelist
から
一覧もしくは展開されるべきファイルのリスト
を読んで、
コマンドラインで指定されたリストに加える。
これは
.B \-t
もしくは
.B \-x
コマンドとともに
使うことができる。
ファイル
.I filelist
は改行で区切られたファイル名を含まなくてはならない。
.I filelist
は通常のファイルか
.I -
(標準入力)
である。
.\"O .TP
.\"O .B \-y
.\"O Do not ask the user whether to abort the restore in the event of an error.
.\"O Always try to skip over the bad block(s) and continue.
.TP
.B \-y
は
エラーの場合においても
restoreを中断するかどうか
ユーザーに問わない。
なるたけ、バッドブロックを飛ばして継続することを試みる。
.\"O .SH DIAGNOSTICS
.\"O Complains if it gets a read error. If 
.\"O .B y
.\"O has been specified, or the user responds
.\"O .BR y ,
.\"O .B restore
.\"O will attempt to continue the restore.
.SH 診断(DIAGNOSTICS)
リードエラーが起きたら診断が表示される。
もし、
.B y
が指定されていたり、
もしくはユーザーが
.BR y 
と返答すると、
.B restore
はリストアを継続しようと試みる。
.\"O .PP
.\"O If a backup was made using more than one tape volume,
.\"O .B restore
.\"O will notify the user when it is time to mount the next volume. If the
.\"O .B \-x
.\"O or
.\"O .B \-i
.\"O flag has been specified,
.\"O .B restore
.\"O will also ask which volume the user wishes to mount. The fastest way to extract
.\"O a few files is to start with the last volume, and work towards the first volume.
.PP
もし、バックアップが1テープより多くのボリュームを使って作られた場合は、
次のボリュームをマウントする時がきたら
.B restore
はユーザーに通知する。
もし、
.B \-x
もしくは
.B \-i
フラグが指定されたら、
.B restore
は
ユーザーがマウントしたいボリュームも問い合わせて来る。
わずかなファイルを展開するもっとも手早い方法は
最終ボリュームから始めて、
最初のボリュームに向かって作業を進めていくことである。
.\"O .PP
.\"O There are numerous consistency checks that can be listed by
.\"O .BR restore .
.\"O Most checks are self-explanatory or can \*(lqnever happen\*(rq. Common errors
.\"O are given below:
.PP
.BR restore .
には多数の一貫性検査がある。
ほとんどのチェックは自明なものや
\*(lq 決して起こりえない \*(rq
ものである。
よくあるエラーを以下に挙げる:
.\"O .TP
.\"O .I Converting to new file system format
.\"O A dump tape created from the old file system has been loaded. It is
.\"O automatically converted to the new file system format.
.TP
.I Converting to new file system format
古いファイルシテスムで生成されたダンプテープがロードされている。
新しいファイルシステム形式に自動的に変換される。
.\"O .TP
.\"O .I <filename>: not found on tape
.\"O The specified file name was listed in the tape directory, but was not found on
.\"O the tape. This is caused by tape read errors while looking for the file, and
.\"O from using a dump tape created on an active file system.
.TP
.I <filename>: not found on tape
指定されたファイル名はテープディレクトリには記載されているが、
テープ上に見付からなかった。
これが起こるのはファイルを探しているときのテープリードエラーや
稼働中のファイルシステムで生成したダンプを使うことによる。
.\"O .TP
.\"O .I expected next file <inumber>, got <inumber>
.\"O A file that was not listed in the directory showed up. This can occur when
.\"O using a dump created on an active file system.
.TP
.I expected next file <inumber>, got <inumber>
ディレクトリにはないファイルが出現した。
これは稼働中のファイルシステムで生成したダンプを使ったときに起こりうる。
.\"O .TP
.\"O .I Incremental dump too low
.\"O When doing an incremental restore, a dump that was written before the previous 
.\"O incremental dump, or that has too low an incremental level has been loaded.
.TP
.I Incremental dump too low
増分リストアをしているとき、
直前の増分ダンプ以前に書かれたダンプか、
増分レベルの低すぎるダンプがロードされている。
.\"O .TP
.\"O .I Incremental dump too high
.\"O When doing an incremental restore, a dump that does not begin its coverage
.\"O where the previous incremental dump left off, or that has too high an 
.\"O incremental level has been loaded.
.TP
.I Incremental dump too high
増分リストアをしているときに、
直前の増分ダンプを終えた後でその適合範囲から始まらないダンプ、
もしくは増分レベルの高すぎるダンプがロードされている。
.\"O .TP
.\"O .I Tape read error while restoring <filename>
.TP
.I Tape read error while restoring <filename>
.\"O .TP
.\"O .I Tape read error while skipping over inode <inumber>
.TP
.I Tape read error while skipping over inode <inumber>
.\"O .TP
.\"O .I Tape read error while trying to resynchronize
.\"O A tape (or other media) read error has occurred. If a file name is specified,
.\"O its contents are probably partially wrong. If an inode is being skipped or the
.\"O tape is trying to resynchronize, no extracted files have been corrupted, though
.\"O files may not be found on the tape.
.TP
.I Tape read error while trying to resynchronize
テープ(もしくは他のメディア)リードエラーが起こった。
ファイル名が指定されていて、
その内容の一部が悪いかも知れない。
inodeがスキップされているとか
テープが再同期を試みるなら、
抽出されたファイルは破損していないものの、
テープ上のファイルは見付けられないかもしれない。
.\"O .TP
.\"O .I resync restore, skipped <num> blocks
.\"O After a dump read error, 
.\"O .B restore
.\"O may have to resynchronize itself. This message lists the number of blocks that
.\"O were skipped over.
.TP
.I resync restore, skipped <num> blocks
ダンプリードエラーの後、
.B restore
は正常に再同期しなくてはならない。
このメッセージは
飛ばしたブロックの数を記載している。
.\"O .SH EXIT STATUS
.\"O .B Restore
.\"O exits with zero status on success. Tape errors are indicated with an exit code
.\"O of 1.
.SH 返り値(EXIT STATUS)
.B Restore
は成功すると 0 で終了する。
1 のexit code はテープエラーを示している。
.\"O .PP
.\"O When doing a comparison of files from a dump, an exit code of 2 indicates that
.\"O some files were modified or deleted since the dump was made.
.PP
ダンプからのファイルを比較を行ったときに、
exit code 2 は、
ダンプが生成されてから
いくらかのファイルが更新されるか削除された
ことを示す。
.\"O .SH ENVIRONMENT
.\"O If the following environment variable exists it will be utilized by
.\"O .BR restore :
.SH 環境変数
もし、以下の環境変数が存在するなら
.BR restore
で利用される。:
.\"O .TP
.\"O .B TAPE
.\"O If no
.\"O .B \-f
.\"O option was specified,
.\"O .B restore
.\"O will use the device specified via
.\"O .B TAPE
.\"O as the dump device.
.\"O .B TAPE
.\"O may be of the form
.\"O .IR tapename ,
.\"O .I host:tapename
.\"O or
.\"O .IR user@host:tapename .
.TP
.B TAPE
もし、
.B \-f
オプションが指定されていない場合、
.B restore
は
ダンプデバイスとして
.B TAPE
で指定されるデバイスを使う。
.B TAPE
は
.IR tapename ,
.I host:tapename
もしくは
.IR user@host:tapename
の形式である。
.\"O .TP
.\"O .B TMPDIR
.\"O The directory given in
.\"O .B TMPDIR
.\"O will be used instead of
.\"O .I /tmp
.\"O to store temporary files.
.TP
.B TMPDIR
.B TMPDIR
で与えられたディレクトリは
.I /tmp
の代わりに一時ファイルを格納するのに使う。
.\"O .TP
.\"O .B RMT
.\"O The environment variable
.\"O .B RMT
.\"O will be used to determine the pathname of the remote
.\"O .BR rmt (8)
.\"O program.
.TP
.B RMT
環境変数
.B RMT
はリモートプログラム
.BR rmt (8)
のパス名を決めるのに使われる。
.\"O .TP
.\"O .B RSH
.\"O .B Restore
.\"O uses the contents of this variable to determine the name of the remote shell 
.\"O command to use when doing a network restore (rsh, ssh etc.). If this variable
.\"O is not set,
.\"O .BR rcmd (3)
.\"O will be used, but only root will be able to do a network restore.
.TP
.B RSH
.B restore
はこの環境変数の内容を
ネットワークリストアするときに
リモートシェルコマンドの名前を決めるのに
つかう。
(rsh, ssh 他)
もし、この変数が設定されていない場合は
.BR rcmd (3)
が使われるが、
rootのみがネットワークリストアできる。
.\"O .SH FILES
.SH ファイル
.\"O .TP
.\"O .I /dev/st0
.\"O the default tape drive
.TP
.I /dev/st0
デフォルトのテープドライブ
.\"O .TP
.\"O .I /tmp/rstdir*
.\"O file containing directories on the tape
.TP
.I /tmp/rstdir*
テープ上のディレクトリを含むファイル
.\"O .TP
.\"O .I /tmp/rstmode*
.\"O owner, mode, and time stamps for directories
.TP
.I /tmp/rstmode*
ディレクトリのオーナー、モード、タイムスタンプ
.\"O .TP
.\"O .I ./restoresymtable
.\"O information passed between incremental restores
.TP
.I ./restoresymtable
増分リストアの間で渡される情報
.\"O .SH SEE ALSO
.\"O .BR dump (8),
.\"O .BR mount (8),
.\"O .BR mke2fs (8),
.\"O .BR rmt (8)
.SH 関連項目
.BR dump (8),
.BR mount (8),
.BR mke2fs (8),
.BR rmt (8)
.\"O .SH BUGS
.\"O .B Restore
.\"O can get confused when doing incremental restores from dumps that were made on
.\"O active file systems.
.SH バグ
稼働中のファイルシステムで作られたダンプから増分リストアをするとき、
.B restore
は誤動作しうる。
.\"O .PP
.\"O A level 0 dump must be done after a full restore. Because 
.\"O .B restore
.\"O runs in user code, it has no control over inode allocation; thus a full dump
.\"O must be done to get a new set of directories reflecting the new inode 
.\"O numbering, even though the content of the files is unchanged.
.PP
フルリストアの後、必ずレベル0ダンプを行うべきである。
なぜなら、
.B restore
はユーザーコードで走るので、
inodeの割り当てまで管理しない; 
なので、たとえファイルの内容を変えていなくとも、
新しいinode番号を反映する
新しいディレクトリ一式を得るためにフルダンプしなくてはならない。
.\"O .PP
.\"O The temporary files
.\"O .I /tmp/rstdir*
.\"O and
.\"O .I /tmp/rstmode*
.\"O are generated with a unique name based on the date of the dump and the process
.\"O ID (see
.\"O .BR mktemp (3) ),
.\"O except when
.\"O .B \-r
.\"O or
.\"O .B \-R
.\"O is used. Because
.\"O .B \-R
.\"O allows you to restart a
.\"O .B \-r
.\"O operation that may have been interrupted, the temporary files should be the 
.\"O same across different processes. In all other cases, the files are unique 
.\"O because it is possible to have two different dumps started at the same time, 
.\"O and separate operations shouldn't conflict with each other.
.PP
テンポラリファイル
.I /tmp/rstdir*
および
.I /tmp/rstmode*
はダンプの日時とプロセスIDに基づいたユニークな名前
(
.BR mktemp (3)
をみること)で生成される、
.B \-r
もしくは
.B \-R
を使うときを除いて。
.B \-R
は
中断された
.B \-r
の作業を再開することができるので、
テンポラリファイルは
異なるプロセスにまたがって同じになるべきである。
他の場合ではすべて、
ファイルはユニークで、
それは
2つの異なるダンプを同時に開始し
それぞれ別の処理どおしが衝突を起こさないためである。
.\"O .PP
.\"O To do a network restore, you have to run 
.\"O .B restore
.\"O as root or use a remote shell replacement (see 
.\"O .B RSH
.\"O variable).  This is due to the previous security history of 
.\"O .B dump 
.\"O and
.\"O .BR restore .
.\"O (
.\"O .B restore
.\"O is written to be setuid root, but we are not certain all bugs are gone from the
.\"O code - run setuid at your own risk.)
.PP
ネットワークリストアをするためには、
.B restore
はrootにて走らせるか、
リモートシェルの置き換え
をしなければならない
(
.B RSH
変数をみること)。
これは、
.B dump 
と
.BR restore
の
これまでのセキュリティの変遷のためである。
(
.B restore
はrootにsetuidするように書かれているが、
コードから全てのバグを取り除いた確証はない。
自己責任にて setuid を走らせること。
)
.\"O .PP
.\"O At the end of restores in
.\"O .B \-i
.\"O or
.\"O .B \-x
.\"O modes (unless
.\"O .B \-o
.\"O option is in use),
.\"O .B restore
.\"O will ask the operator whether to set the permissions on the current
.\"O directory. If the operator confirms this action, the permissions 
.\"O on the directory from where 
.\"O .B restore
.\"O was launched will be replaced by the permissions on the dumped root
.\"O inode. Although this behaviour is not really a bug, it has proven itself
.\"O to be confusing for many users, so it is recommended to answer 'no', 
.\"O unless you're performing a full restore and you do want to restore the
.\"O permissions on '/'.
.PP
.B \-i
もしくは
.B \-x
モードで
リストアの最後で
(
.B \-o
オプションが使われていなければ)、
.B restore
は
カレントディレクトリのパーミッションをセットするかどうか聞いて来る。
もしこの実行を認めると、
.B restore
を発行したディレクトリのパーミッションが
ダンプ元のinodeのパーミッションで
置き換えられる。
この挙動は本当のバグでないにもかかわらず、
多くのユーザを当惑させることが分かっていて、
なのでnoと答えることを推奨している、
フルリストアをする場合や、'/' のパーミッションを復元しようとしている場合でなければ。
.\"O .SH AUTHOR
.\"O The
.\"O .B dump/restore
.\"O backup suite was ported to Linux's Second Extended File System by Remy Card 
.\"O <card@Linux.EU.Org>. He maintained the initial versions of 
.\"O .B dump
.\"O (up and including 0.4b4, released in january 1997).
.\"O .PP
.\"O Starting with 0.4b5, the new maintainer is Stelian Pop <stelian@popies.net>.
.SH 著者
.B dump/restore
バックアップsuiteは
Remy Card <card@Linux.EU.Org>
によって
Linuxのext2ファイルシステム(Second Extended File System)
に移植された。
彼は
.B dump
の初期バージョンを保守した
(1997年1月にリリースされた0.4b4を含む以後)。
.PP
0.4b5からは、
新しいメンテナは
Stelian Pop <stelian@popies.net>
である。
.\"O .SH AVAILABILITY
.\"O The
.\"O .B dump/restore
.\"O backup suite is available from <http://dump.sourceforge.net>
.SH 入手
.B dump/restore
バックアップsuiteは
<http://dump.sourceforge.net>
から入手できる。
.\"O .SH HISTORY
.\"O The
.\"O .B restore
.\"O command appeared in 4.2BSD.
.SH 履歴
.B restore
コマンドは
4.2BSD
で登場した。
