.\" Copyright (c) 1996, 1997, 1999 Thorsten Kukuk <kukuk@suse.de>
.\" Copyright (c) 1996, 1997, 1999, 2001 Thorsten Kukuk <kukuk@suse.de>

.\" $Id: ypxfr.8,v 1.4 2001/12/01 15:25:31 nakano Exp $
.\" 
.\" This manual page is a part of ypserv archive. 
.\" README states the following
.\"
.\" See the file COPYING for copying restrictions. It is available under
.\" the GNU General Public License.
.\"
.\" Japanese Version Copyright (c) 1998, 1999 NAKANO Takeo all rights reserved.
.\" Translated Mon 23 Nov 1998 by NAKANO Takeo <nakano@apm.seikei.ac.jp>
.\" Updated Fri 22 Oct 1999 by NAKANO Takeo
.\"
.\"O .TH YPSERV 8 "August 2001" "YP Server" ""
.TH YPXFR 8 "August 2001" "YP Server" ""
.\"O .SH NAME
.\"O ypxfr - transfer NIS database from remote server to local host
.SH 名前
ypxfr \- NIS データーベースをリモートサーバーからローカルホストに転送する
.\"O .SH SYNOPSIS
.SH 書式
.B /usr/lib/yp/ypxfr
[
.B \-f
]
[
.B \-c
]
[
.B \-d
.I target domain
]
.if n .ti +5n
[
.B \-h
.I source host
]
[
.B \-s
.I source domain
]
.if n .ti +5n
[
.B \-C
.I taskid
.I program-number
.I ipaddr port
]
.if n .ti +5n
[
.B \-p
.I yp_path
]
mapname ...

.\"O .SH DESCRIPTION
.SH 説明
.\"O .B ypxfr
.\"O copies an NIS database from one NIS server to the local host by
.\"O using the NIS service.
.B ypxfr
は NIS データーベースを NIS サーバーからローカルホストに
NIS サービスを用いてコピーする。
.\"O .B ypxfr
.\"O is generally invoked by
.\"O .B ypinit
.\"O or by
.\"O .B ypserv,
.\"O when
.\"O .B ypserv
.\"O receives a map transfer request from
.\"O .B yppush.
.B ypxfr
は通常
.B ypinit
から起動されるか、
.B yppush
からマップ転送要求を受け取った
.B ypserv
によって起動される。
.\"O It creates a temporary map in the directory
.\"O .B /var/yp/domain
.\"O (this  directory  must already  exist;
.\"O .I domain
.\"O is the default domainname for the local host), fills it by getting
.\"O the map's entries and fetches the map parameters (master and order number).
.B ypxfr
は一時的なマップを
.B /var/yp/domain
ディレクトリに生成し (このディレクトリは存在していなければならない。
.I domain
はローカルホストのデフォルトドメイン名である)、
そのマップのエントリを取得して内容を書き込み、マップのパラメータ
(マスターとオーダー番号) を取得する。
.\"O If the transfer was successful, the old version of the map will be
.\"O deleted and the temporary copy will be moved into its place.
.\"O Then,
.\"O .B ypxfr
.\"O will attempt to send a "clear current map" request to the local
.\"O .B ypserv.
転送が成功したら、古いバージョンのマップは削除され、
この一時的なマップの内容がそこに書き込まれる。
次に
.B ypxfr
は "clear current map" 要求をローカルの
.B ypserv
に送ろうと試みる。

.\"O If  run interactively,
.\"O .B ypxfr
.\"O writes its output to stderr.
.\"O However, if it is invoked without a controlling terminal, it will
.\"O log the output to syslog.
インタラクティブな形式で実行されると、
.B ypxfr
は出力を標準エラー出力に書き出す。しかし制御端末なしで
起動された場合には、出力は syslog に記録される。

.\"O .B ypxfr
.\"O is used primarily in environments where several NIS servers are in use.
.\"O For all maps, you have a NIS master server, which  maintains a canonical
.\"O copy of the NIS map, and all the other servers, the NIS slaves, copy
.\"O the new version of the map from the master whenever a update was made.
.\"O Normally, you have one NIS master for all maps.
.B ypxfr
が用いられるのは、複数の NIS サーバーが用いられているような
環境においてである。あらゆるマップに対して、そのマップの原本を
保持している NIS マスターサーバーが一つだけ存在する。他のサーバは
すべて NIS スレーブサーバーとなり、マスターサーバーでマップが
更新されるたびに、新しい版のマップをコピーする。
通常は一台の NIS サーバーにすべてのマップの管理を集中させる。

.\"O In order to maintain consistency across all NIS servers,
.\"O .B ypxfr
.\"O can be run periodically in a
.\"O .B cron
.\"O job. Maps which change infrequently need only be updated once a day
.\"O (preferably late at night when system usage is lowest), where those
.\"O with frequent changes (such as
.\"O .I passwd.byname
.\"O and
.\"O .I passwd.byuid )
.\"O should be updated perhaps once every hour.
これらすべての NIS サーバーの間でマップの内容を一致させておくためには、
.B ypxfr
を
.B cron
ジョブとして定期的に動作させると良い。あまり変更されないマップは
一日に一回更新すればよいだろうし (システムの使用率が最低となるような
夜遅くが好まれる)、頻繁に変更されるマップ (
.IR passwd.byname " や " passwd.byuid
など) は一時間に一回くらい更新する必要があるかもしれない。
.\"O Examples are in
.\"O .B /usr/lib/yp: ypxfr_1perday, ypxfr_2perday,
.\"O and
.\"O .B ypxfr_1perhour.
.\"O They can serve as reasonable first cuts.
これらの例は
.B /usr/lib/yp
の
.BR ypxfr_1perday ", " ypxfr_2perday ", " ypxfr_1perhour
などに示してある。とりあえず動かしてみるには、
これらを用いてみると良いだろう。

.\"O Normally all updates should be propagated by
.\"O .B yppush
.\"O when
.\"O .B /var/yp/Makefile
.\"O is run on the NIS master server, however it is a good practice
.\"O on large networks where possible outages could cause NIS slaves to
.\"O fall out of sync with the master.
NIS マスターサーバーで
.B /var/yp/Makefile
が実行されたら、
通常はその更新内容を
.B yppush
を用いて伝播させるべきである。
しかし大きなネットワークの場合には、通信障害などによって
NIS スレーブの同期がマスターとずれることもあるだろうから、
このように
.B ypxfr
を使うのは良いことである。

.\"O .SH OPTIONS
.\"O The following options are supported:
.SH オプション
以下のオプションがサポートされている。
.TP
.B \-f
.\"O Force a map transfer. Normally,
.\"O .B ypxfr
.\"O will not transfer a map if it determines that the NIS master's copy
.\"O is not newer than the existing copy already on the local host. This
.\"O flag forces a transfer regardless of which server's version is more
.\"O recent.
マップの転送を強制する。通常の動作では、
NIS マスターにあるマップがローカルホストにすでに存在するコピーよりも
新しくないと判断されると、
.B ypxfr
はマップの転送を行わない。このフラグを指定すると、
どのサーバーの版が最新であるかを問わず、強制的に転送が行われる。
.TP
.B \-c
.\"O Do not send a "clear current map" request to the
.\"O .B ypserv
.\"O process running on the local host. This flag is normally used when
.\"O invoking
.\"O .B ypxfr
.\"O by
.\"O .B ypinit
.\"O or if
.\"O .B ypserv
.\"O is not  running  locally  at  the time you are running
.\"O .B ypxfr.
.\"O Otherwise,
.\"O .B ypxfr
.\"O will complain that it cannot talk to the local
.\"O .B ypserv,
.\"O and the transfer will fail.
ローカルで動作している
.B ypserv
プロセスに "clear current map" 要求を送らない。
.B ypxfr
が
.B ypinit
から起動された場合や、
.B ypxfr
の起動時に
.B ypserv
が動作していない場合などには通常このフラグを指定する。さもないと
.B ypxfr
はローカルの
.B ypserv
と通信できない旨のエラーを出し、転送は失敗する。
.TP
.BI \-d " domain"
.\"O Specify a domain other than the default NIS domain.
デフォルトの NIS ドメインの代わりに用いるドメインを指定する。
.TP
.BI \-h " source host"
.\"O Get the map from
.\"O .IR host ,
.\"O regardless of what the map says the master is.  If
.\"O .I host
.\"O is not specified,
.\"O .B ypxfr
.\"O asks the
.\"O .SM NIS
.\"O service for the name of the master, and tries to get the
.\"O map from there. This option is used to insure that ypxfr only copies
.\"O maps from the NIS master server.
マップに書かれているマスターの情報を無視して、マップを
.I host
から取得する。
.I host
が指定されない場合には、
.B ypxfr
は
.SM NIS
サービスにマスターの名前を問い合わせて、そこからマップを取得しようとする。
このオプションは
.B ypxfr
がマップの取得先とする NIS マスターサーバーを保証するために用いられる。
.TP
.BI \-s " source domain"
.\"O Specify a source domain from which to transfer a map that should be the same
.\"O across domains.
マップの取得先とするソースドメインを指定する。
そのマップをドメインを通して同じものとしたい場合に有効。
.TP
.BI \-C  " taskid progam-number ipaddr port"
.\"O This option is
.\"O .B only
.\"O for use by
.\"O .B ypserv .
.\"O When
.\"O .B ypserv
.\"O invokes
.\"O .BR ypxfr ,
.\"O it specifies that
.\"O .B ypxfr
.\"O should call back a
.\"O .B yppush
.\"O process at the host with
.\"O .SM IP
.\"O address
.\"O .IR ipaddr ,
.\"O registered as program number
.\"O .IR progam-number ,
.\"O listening on port
.\"O .IR port ,
.\"O and waiting for a response to transaction
.\"O .IR taskid .
このオプションは
.B ypserv
によって\fBのみ\fP用いられる。
.B ypserv
が
.B ypxfr
を起動するときに、
.B ypxfr
が
.B yppush
プロセスをコールバックする先 (
.SM IP
アドレス
.I ipaddr
のホストの、予約済みプログラム番号
.IR progam-number 、
ポート番号
.IR port
が、トランザクション
.I taskid
へのレスポンスを待っている)
を指定する。
.TP
.BI \-p " yp_path"
.\"O Change the directory for the maps to
.\"O \fIyp_path/[domainname]/\fP, the default
.\"O is \fI/var/yp/[domainname]\fP.
マップのディレクトリを
.I yp_path/[domainname]
に変更する。デフォルトは
.I /var/yp/[domainname]
である。
.TP
.I mapname
.\"O One or more names of the map to transfer.
転送するマップの名前を指定する (複数指定可)。
.\"O .SH FILES
.SH ファイル
/var/yp/[domainname]/[maps]
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR ypserv (8),
.BR yppush (8),
.BR ypinit (8),
.BR cron (8),
.BR crontab (5)
.\"O .SH AUTHOR
.SH 著者
Thorsten Kukuk <kukuk@suse.de>
