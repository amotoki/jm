.\"                                              -*- nroff -*-
.\" 1998-02-05 written by Jim Van Zandt <jrv@vanzandt.mv.com>
.TH GET_USER 9 "February 5, 1998" "Linux DDI" "Kernel Functions"
.SH NAME
get_user, put_user, copy_from_user, copy_to_user \- copy data 
between kernel space and user space
.SH SYNOPSIS
.B #include <asm/uaccess.h>
.sp
.nf
.IB err " = get_user ( " x ", " addr " );"
.IB err " = put_user ( " x ", " addr " );"
.sp
.IB bytes_left " = copy_from_user(void*" to ", const void *" from ,
.BI "                            unsigned long " n " );"
.IB bytes_left " = copy_to_user(void*" to ", const void *" from ,
.BI "                          unsigned long " n " );"
.fi
.SH DESCRIPTION
These macros transfer data between kernel space and user space.  In
the first example, the kernel variable \fIx\fP gets the value of the
thing pointed to by \fIaddr\fP (in user space).  For \fBput_user\fP,
the value of the variable \fIx\fP is written starting at the address
\fIaddr\fP.  Note well that \fIx\fP is a \fBvariable\fP, not a
pointer.  \fIaddr\fP must be a properly typed pointer, since its type
determines number of bytes that are copied.
.PP
\fBcopy_from_user\fP copies \fIn\fP bytes from address \fIfrom\fP in
user space to address \fIto\fP in kernel space.  \fBcopy_to_user\fP
copies in the opposite direction.
.PP
None of these need the old \fBverify_area\fP() call, as they do all
the area verification on their own using the paging unit in the CPU
hardware.  Less chance of missing address verification that way.
Also, the new address verification is much faster than the old scheme
was.
.SH "RETURN VALUE"
\fBget_user\fP and \fPput_user\fP return \fB0\fP for success and
\fP-EFAULT\fP for bad access.  \fBcopy_from_user\fP and
\fBcopy_to_user\fP return the number of bytes they \fBfailed\fP to
copy (so again zero is a successful return).
.SH EXAMPLES
.sp
.nf
	if (get_user(type, (char *)arg))
	return -EFAULT;
	switch (type) {
	...
.fi
.sp
.nf
	b.maxwidth = 768;
	b.maxheight = 576;
	b.minwidth = 32;
	b.minheight = 32;
	if(copy_to_user(arg, &b, sizeof(b)))
	    return -EFAULT;
	return 0;
	...
.fi
.sp
.SH AVAILABILITY
Linux 2.1.4+
.SH "SEE ALSO"
.BR verify_area "(9)"
.SH AUTHOR
Manual page by Jim Van Zandt <jrv@vanzandt.mv.com>

