.\" Copyright (c) 1988 Massachusetts Institute of Technology,
.\" Student Information Processing Board.  
.\"
.\" Japanese Version Copyright (c) 2000 NAKANO Takeo all rights reserved.
.\" Translated Thu 13 2000 by NAKANO Takeo <nakano@apm.seikei.ac.jp>
.\" 
.TH COM_ERR 3 "22 Nov 1988" SIPB
.\"O .SH NAME
.\"O com_err \- common error display routine
.SH 名前
com_err \- 汎用のエラー表示ルーチン
.\"O .SH SYNOPSIS
.SH 書式
.nf
 #include <et/com_err.h>
void (*\fIproc\fR) (const char *, long, const char *, va_list);
.PP
void com_err (const char *whoami, long code, const char *format, ...);
.PP
proc = set_com_err_hook (proc);
.PP
proc = reset_com_err_hook ();
.PP
void initialize_XXXX_error_table ();
.fi
.\"O .SH DESCRIPTION
.SH 説明
.\"O .I Com_err
.\"O displays an error message on the standard error stream
.\"O .I stderr
.\"O (see
.\"O .IR stdio (3S))
.\"O composed of the
.\"O .I whoami
.\"O string, which should specify the program name or some subportion of
.\"O a program, followed by an error message generated from the
.\"O .I code
.\"O value (derived from
.\"O .IR compile_et (1)),
.\"O and a string produced using the
.\"O .I format
.\"O string and any following arguments, in the same style as
.\"O .IR fprintf (3).
.I com_err
はエラーメッセージを標準エラーストリーム
.I stderr
.RI ( stdio (3S)
を見よ)
に表示する。エラーメッセージは、
.I whoami
文字列 (プログラムの名前やプログラムのある部分を示す)・
値
.I code
.RI ( compile_et (1)
から引かれる)・
.BR fprintf (3)
スタイルの
.I format
文字列を使って、残りの引数から
生成した文字列、の 3 つの部分からなる。

.\"O The behavior of
.\"O .I com_err
.\"O can be modified using
.\"O .I set_com_err_hook;
.\"O this defines a procedure which is called with the arguments passed to
.\"O .I com_err,
.\"O instead of the default internal procedure which sends the formatted
.\"O text to error output.  Thus the error messages from a program can all
.\"O easily be diverted to another form of diagnostic logging, such as
.\"O .IR syslog (3).
.\"O .I Reset_com_err_hook
.\"O may be used to restore the behavior of
.\"O .I com_err
.\"O to its default form.  Both procedures return the previous ``hook''
.\"O value.  These ``hook'' procedures must have the declaration given for
.\"O .I proc
.\"O above in the synopsis.
.I com_err
の動作は
.I set_com_err_hook
を用いて変更できる。
これは
.I com_err
に渡される引数を用いて呼び出される関数を定義する。
デフォルトでは内部の関数が用いられ、これは整形したテキストをエラー出力に送る。
つまり、プログラムからのエラーメッセージを、例えば
.BR syslog (3)
のような診断ログに振り向けることが容易にできるわけである。
.I reset_com_err_hook
を用いると、
.I com_err
の動作をデフォルトの形式に戻すことができる。
この両関数は、実行前の ``hook'' の値を返す。
これらの ``hook'' 関数は、書式の部分で示した
.I proc
のように宣言しなければならない。

.\"O The
.\"O .I initialize_XXXX_error_table
.\"O routine is generated mechanically by
.\"O .IR compile_et (1)
.\"O from a source file containing names and associated strings.  Each
.\"O table has a name of up to four characters, which is used in place of
.\"O the
.\"O .B XXXX
.\"O in the name of the routine.  These routines should be called before
.\"O any of the corresponding error codes are used, so that the
.\"O .I com_err
.\"O library will recognize error codes from these tables when they are
.\"O used.
.I initialize_XXXX_error_table
ルーチンは、名前とそれに対応する文字列とからなるソースファイルから
.IR compile_et (1)
によって自動的に生成される。
.\"O nakano: mechanically?
それぞれの表は 4 文字までの名前を持ち、ルーチンの名前の
.B XXXX
の部分になる。これらのルーチンは、
各エラーコードを用いる前に呼び出しておき、
.I com_err
ライブラリが
エラーコードをこれらの表から認識できるようにしておかなければならない。

.\"O The
.\"O .B com_err.h
.\"O header file should be included in any source file that uses routines
.\"O from the
.\"O .I com_err
.\"O library; executable files must be linked using
.\"O .I ``-lcom_err''
.\"O in order to cause the
.\"O .I com_err
.\"O library to be included.
.I com_err
ライブラリのルーチンを用いる全てのソースファイルは、
.B com_err.h
ヘッダーファイルをインクルードしなければならない。
実行ファイルをリンクするときには、
.I ``-lcom_err''
を用いて
.I com_err
ライブラリが含まれるようにしなければならない。
.\"O 
.\" .IR for manual entries
.\" .PP for paragraph breaks
.\"O 
.\"O .SH "SEE ALSO"
.SH 関連項目
.\"O compile_et (1), syslog (3).
.BR compile_et (1),
.BR syslog (3)

Ken Raeburn, "A Common Error Description Library for UNIX".


