.\" Access Control Lists manual pages
.\"
.\" (C) 2000 Andreas Gruenbacher, <a.gruenbacher@bestbits.at>
.\"
.\" This manual page may used unter the terms of the GNU LGPL license, either
.\" version 2 of this license, or (at your option) any later version.
.\"
.\" Japanese Version Copyright (c) 2005 Yuichi SATO
.\"         all rights reserved.
.\" Translated Sun Jun 12 01:15:13 JST 2005
.\"         by Yuichi SATO <ysato444@yahoo.co.jp>
.\"
.TH SETFACL 1 "ACL File Utilities" "May 2000" "Access Control Lists"
.\"O .SH NAME
.SH 名前
.\"O setfacl \- set file access control lists
setfacl \- ファイルのアクセス制御リスト (access control list) を設定する
.\"O .SH SYNOPSIS
.SH 書式

.B setfacl
[\-bkndRLPvh] [{\-m|\-x} acl_spec] [{\-M|\-X} acl_file] file ...

.B setfacl
\-\-restore=file

.\"O .SH DESCRIPTION
.SH 説明
.\"O This utility sets Access Control Lists (ACLs) of files and directories.
.\"O On the command line, a sequence of commands is followed by a sequence of
.\"O files (which in turn can be followed by another sequence of commands, ...).
このユーティリティはファイルとディレクトリの
アクセス制御リスト (Access Control List, ACL) を設定する。
コマンドラインでは、一連のコマンドの後にファイル群を指定する
(さらに別の一連のコマンド、ファイル群、... を続けて指定することができる)。

.\"O The options
.\"O .I \-m,
.\"O and
.\"O .I \-x
.\"O expect an ACL on the command line. Multiple ACL entries are separated
.\"O by comma characters (`,'). The options
.\"O .I \-M,
.\"O and
.\"O .I \-X
.\"O read an ACL from a file or from standard input. The ACL entry format is described in Section
.\"O ACL ENTRIES.
オプション
.I \-m
と
.I \-x
は ACL がコマンドラインで指定されることを想定している。
複数の ACL エントリはコンマ文字 (`,') で区切られる。
オプション
.I \-M
と
.I \-X
は ACL をファイルまたは標準入力から読み込む。
ACL エントリの書式は、「ACL エントリ」のセクションで説明されている。

.\"O The
.\"O .IR "\-\-set" " and " "\-\-set-file"
.\"O options set the ACL of a file or a directory. The previous ACL is
.\"O replaced.
.\"O ACL entries for this operation must include permissions.
.IR "\-\-set" " と " "\-\-set-file"
オプションはファイルとディレクトリの ACL を設定する。
以前の ACL は置き換えられる。
この操作で指定される ACL エントリは、
許可 (permission) を含まなければならない。

.\"O The
.\"O .IR "\-m (\-\-modify)" " and " "\-M (\-\-modify-file)"
.\"O options modify the ACL of a file or directory.
.\"O ACL entries for this operation must include permissions.
.IR "\-m (\-\-modify)" " と " "\-M (\-\-modify-file)"
オプションはファイルとディレクトリの ACL を変更する。
この操作で指定される ACL エントリは、許可を含まなければならない。

.\"O The
.\"O .IR "\-x (\-\-remove)" " and " "\-X (\-\-remove-file)"
.\"O options remove ACL enries. Only
.\"O ACL entries without the
.\"O .I perms
.\"O field are accepted as parameters, unless POSIXLY_CORRECT is defined.
.IR "\-x (\-\-remove)" " と " "\-X (\-\-remove-file)"
オプションは ACL エントリを削除する。
POSIXLY_CORRECT が定義されていない場合は、
.I perms
フィールドを持たない ACL エントリだけが引き数として指定できる。

.\"O When reading from files using the 
.\"O .I \-M,
.\"O and
.\"O .IR \-X
.\"O options, setfacl accepts the output getfacl produces.
.I \-M
と
.I \-X
オプションで (ACL を) ファイルから読み込む場合、
setfacl は getfacl が生成した出力を受け付ける。
.\"O There is at most one ACL entry per line. After a Pound sign (`#'),
.\"O everything up to the end of the line is treated as a comment.
1 行には最大で 1 つの ACL エントリがある。
シャープ記号 (`#') の後から行末まではコメントとして扱われる。

.\"O If setfacl is used on a file system which does not support ACLs, setfacl
.\"O operates on the file mode permission bits. If the ACL does not fit completely
.\"O in the permission bits, setfacl modifies the file mode permission bits to reflect the ACL as closely as possible, writes an error message to standard error, and returns with an exit status greater than 0.
ACL をサポートしないファイルシステム上で setfacl を使用した場合、
setfacl はファイルモード許可ビットを操作する。
ACL が許可ビットと完全には合わない場合、
setfacl はファイルモード許可ビットを ACL に可能な限り近づけるように変更し、
標準エラー出力にエラーメッセージを書き出して、0 より大きい終了状態で返る。

.\"O .SS PERMISSIONS
.SS 許可
.\"O The file owner and processes capable of CAP_FOWNER are granted the right
.\"O to modify ACLs of a file. This is analogous to the permissions required
.\"O for accessing the file mode. (On current Linux systems, root is the only
.\"O user with the CAP_FOWNER capability.)
ケーパビリティ (capability) CAP_FOWNER を持つファイル所有者とプロセスは、
ファイルの ACL を変更する権限が付与されている。
これはファイルモードにアクセスするのに必要な許可と類似している
(現在の Linux システムでは、CAP_FOWNER ケーパビリティを持つユーザは
root のみである)。

.\"O .SS OPTIONS
.SS オプション
.TP 4
.I \-b, \-\-remove-all
.\"O Remove all extended ACL entries. The base ACL entries of the owner, group and others are retained.
全ての拡張 ACL エントリを削除する。
所有者・グループ・その他という基本 (base) ACL エントリは保存される。
.TP 4
.I \-k, \-\-remove-default
.\"O Remove the Default ACL. If no Default ACL exists, no warnings are issued.
デフォルト ACL を削除する。
デフォルト ACL が存在しない場合、警告は出されない。
.TP 4
.I \-n, \-\-no-mask
.\"O Do not recalculate the effective rights mask. The default behavior of
.\"O setfacl is to recalculate the ACL mask entry, unless a mask entry was explicitly given.
実効権 (effective right) マスクを再計算しない。
setfacl のデフォルト動作では、ACL マスクエントリが明示的に指定されない限り、
ACL マスクエントリを再計算する。
.\"O The mask entry is set to the union of all permissions of the owning group, and all named user and group entries. (These are exactly the entries affected by the mask entry).
マスクエントリは所有グループ・指名ユーザ (named user)・指名グループの
エントリの全ての許可を結合したものに設定される
(マスクエントリに影響を受けるエントリは、正にこれらである)。
.TP 4
.I \-\-mask
.\"O Do recalculate the effective rights mask, even if an ACL mask entry was explicitly given. (See the
.\"O .IR "\-n " option.)
ACL マスクエントリが明示的に指定されている場合でも、実効権マスクを再計算する
.RI ( \-n
オプションを参照)。
.TP 4
.I \-d, \-\-default
.\"O All operations apply to the Default ACL. Regular ACL entries in the
.\"O input set are promoted to Default ACL entries. Default ACL entries in
.\"O the input set are discarded. (A warning is issued if that happens).
全ての操作をデフォルト ACL に適用する。
入力セットに含まれる通常の ACL エントリを
デフォルト ACL エントリに昇格させる。
入力セットに含まれるデフォルト ACL エントリは破棄される
(これが起こった場合は警告を出す)。
.TP 4
.I \-\-restore=file
.\"O Restore a permission backup created by `getfacl \-R' or similar. All permissions
.\"O of a complete directory subtree are restored using this mechanism. If the input
.\"O contains owner comments or group comments, and setfacl is run by root, the
.\"O owner and owning group of all files are restored as well. This option cannot be mixed with other options except `\-\-test'.
`getfacl \-R' またはそれと同様なもので作成された
許可のバックアップで復旧する。
ディレクトリサブツリーの全ての許可が、この方法で復旧される。
入力に所有者コメントまたはグループコメントが含まれていて、
かつ setfacl が root によって実行されている場合、
全てのファイルの所有者と所有グループも復旧される。
この操作は `\-\-test' 以外のオプションと併用できない。
.TP 4
.I \-\-test
.\"O Test mode. Instead of changing the ACLs of any files, the resulting ACLs are listed.
テストモード。
ファイルの ACL を変更する代わりに、結果の ACL の一覧を表示する。
.TP 4
.I \-R, \-\-recursive
.\"O Apply operations to all files and directories recursively. This option cannot be mixed with `\-\-restore'.
全てのファイルとディレクトリに対して再帰的に操作を適用する。
このオプションは `\-\-restore' と併用できない。
.TP 4
.I \-L, \-\-logical
.\"O Logical walk, follow symbolic links. The default behavior is to follow symbolic link arguments, and to skip symbolic links encountered
.\"O in subdirectories. This option cannot be mixed with `\-\-restore'.
論理的に辿り、シンボリックリンクを辿る。
デフォルトの動作では、シンボリックリンク引き数を辿り、
サブディレクトリで見つかったシンボリックリンクはスキップする。
このオプションは `\-\-restore' と併用できない。
.TP 4
.I \-P, \-\-physical
.\"O Physical walk, skip all symbolic links. This also skips symbolic link arguments.
.\"O This option cannot be mixed with `\-\-restore'.
物理的に辿り、全てのシンボリックリンクをスキップする。
シンボリックリンク引き数もスキップする。
このオプションは `\-\-restore' と併用できない。
.TP 4
.I \-\-version
.\"O Print the version of setfacl and exit.
setfacl のバージョンを表示し、終了する。
.TP 4
.I \-\-help
.\"O Print help explaining the command line options.
コマンドラインオプションを説明するヘルプを表示する。
.TP 4
.I \-\-
.\"O End of command line options. All remaining parameters are interpreted as file names, even if they start with a dash.
コマンドラインオプションの終わり。
残りの引き数は、たとえダッシュ文字で始まっていたとしても、
ファイル名として解釈される。
.TP 4
.I \-
.\"O If the file name parameter is a single dash, setfacl reads a list of files from standard input.
ファイル名引き数が 1 つのダッシュ文字である場合、
setfacl は標準入力からファイルのリストを読み込む。

.\"O .SS ACL ENTRIES
.SS ACL エントリ
.\"O The setfacl utility recognizes the following ACL entry formats (blanks
.\"O inserted for clarity):
setfacl ユーティリティは以下の ACL エントリ書式を認識する
(分かりやすいように空白を挿入してある):

.fam C
.TP
.RI "[d[efault]:] [u[ser]:]" "uid " [: perms ]
.fam T
.\"O Permissions of a named user. Permissions of the file owner if
.\"O .I uid
.\"O is empty.
指名ユーザの許可。
.I uid
が空の場合は、ファイル所有者の許可。
.fam C
.TP
.RI "[d[efault]:] g[roup]:" "gid " [: perms ]
.fam T
.\"O Permissions of a named group. Permissions of the owning group if
.\"O .I gid
.\"O is empty.
指名グループの許可。
.I gid
が空の場合は、所有者グループの許可。
.fam C
.TP
.RI "[d[efault]:] m[ask][:] [:" perms ]
.fam T
.\"O Effective rights mask
実効権マスク。
.fam C
.TP
.RI "[d[efault]:] o[ther][:] [:" perms ]
.fam T
.\"O Permissions of others.
その他の許可。
.PP
.\"O Whitespace between delimiter characters and non-delimiter characters is ignored.
区切り文字と区切り文字以外の間の空白は無視される。
.PP
.PP
.\"O Proper ACL entries including permissions are used in modify and set operations. (options
.\"O .IR \-m ", " \-M ", " \-\-set " and " \-\-set-file ).
許可を含む正式な ACL エントリは、修正と設定の操作
(オプション
.IR \-m ", " \-M ", " \-\-set ", " \-\-set-file )
で使用される。
.\"O Entries without the
.\"O .I perms
.\"O field are used for
.\"O .I deletion
.\"O of entries (options
.\"O .IR \-x " and " \-X ).
.I perms
フィールドのないエントリは、エントリの\fI削除\fR (オプション
.IR \-x " と " \-X )
で使用される。
.PP
.\"O For
.\"O .I uid
.\"O and
.\"O .I gid
.\"O you can specify either a name or a number.
.I uid
と
.I gid
には名前と数値のどちらも指定できる。
.PP
.\"O The
.\"O .I perms
.\"O field is a combination of characters that indicate the permissions: read
.\"O .IR (r) ,
.\"O write
.\"O .IR (w) ,
.\"O execute
.\"O .IR (x) ,
.\"O execute only if the file is a directory or already has execute permission
.\"O for some user
.\"O .IR (X) .
.I perms
フィールド許可を表す文字の組み合わせである。
読み込み
.IR (r) ,
書き込み
.IR (w) ,
実行
.I (x)
は、ファイルがディレクトリであるか何れかのユーザの実行許可
.I (X)
が既にある場合にのみ実行される。
.\"O Alternatively, the
.\"O .I perms
.\"O field can be an octal digit (0\-7).
文字の組合わせの代わりに、
.I perms
フィールドを 8 進数 (0\-7) にすることもできる。
.PP
.\"O .SS AUTOMATICALLY CREATED ENTRIES
.SS 自動的に作成されるエントリ
.\"O Initially, files and directories contain only the three base ACL entries
.\"O for the owner, the group, and others. There are some rules that
.\"O need to be satisfied in order for an ACL to be valid:
初期状態では、ファイルとディレクトリは所有者・グループ・その他という
3 つの基本 ACL エントリを持つ。
ACL が有効であるためには満たさなければならない、いくつかのルールがある。
.IP * 4
.\"O The three base entries cannot be removed. There must be exactly one
.\"O entry of each of these base entry types.
3 つの基本エントリは削除できない。
これらの基本エントリ型のそれぞれに対して、
必ず 1 つのエントリがなければならない。
.IP * 4
.\"O Whenever an ACL contains named user entries or named group objects,
.\"O it must also contain an effective rights mask.
ACL が指名ユーザエントリまたは指名グループオブジェクトを持つ場合、
実効権マスクも持たなければならない。
.IP * 4
.\"O Whenever an ACL contains any Default ACL entries, the three Default ACL
.\"O base entries (default owner, default group, and default others) must also exist.
ACL がデフォルト ACL エントリを持つ場合、
3 つのデフォルト ACL 基本エントリ (デフォルト所有者・
デフォルトグループ・デフォルトのその他) が存在しなければならない。
.IP * 4
.\"O Whenever a Default ACL contains named user entries or named group objects,
.\"O it must also contain a default effective rights mask.
デフォルト ACL が指名ユーザエントリまたは指名グループオブジェクトを持つ場合、
デフォルト実効権マスクも持たなければならない。
.PP
.\"O To help the user ensure these rules, setfacl creates entries from existing
.\"O entries under the following conditions:
ユーザがこれらのルールを確実に守るための助けとして、
setfacl は以下の条件で既存のエントリからエントリを作成する:
.IP * 4
.\"O If an ACL contains named user or named group entries, and
.\"O no mask entry exists, a mask entry containing the same permissions as
.\"O the group entry is created. Unless the
.\"O .I \-n
.\"O option is given, the permissions of the mask entry are further adjusted to include the union of all permissions affected by the mask entry. (See the
.\"O .I \-n
.\"O option description).
ACL が指名ユーザまたは指名グループのエントリを持ち、
かつマスクエントリが存在しない場合、
グループエントリと同じ許可を持つマスクエントリが作成される。
.I \-n
オプションが指定されない限り、マスクエントリの許可は、
そのマスクエントリの影響を受ける全ての許可を合わせたもの含めるように、
更に調整される
.RI ( \-n
オプションの説明を参照すること)。
.IP * 4
.\"O If a Default ACL entry is created, and the Default ACL contains no
.\"O owner, owning group, or others entry, a copy of the ACL owner, owning group, or others entry is added to the Default ACL.
デフォルト ACL エントリが作成され、
かつデフォルト ACL が所有者・所有グループ・その他のエントリを持たない場合、
ACL 所有者・所有グループ・その他のエントリのコピーが
デフォルト ACL に追加される。
.IP * 4
.\"O If a Default ACL contains named user entries or named group entries, and no mask entry exists, a mask entry containing the same permissions as the default Default ACL's group entry is added. Unless the
.\"O .I \-n
.\"O option is given, the permissions of the mask entry are further adjusted to inclu
.\"O de the union of all permissions affected by the mask entry. (See the
.\"O .I \-n
.\"O option description).
デフォルト ACL が指名ユーザまたは指名グループのエントリを持ち、
かつマスクエントリが存在する場合、
デフォルト ACL のグループエントリと同じ許可を持つマスクエントリが追加される。
.I \-n
オプションが指定されない限り、マスクエントリの許可は、
そのマスクエントリの影響を受ける全ての許可を合わせたもの含めるように、
更に調整される
.RI ( \-n
オプションの説明を参照すること)。
.PP
.\"O .SH EXAMPLES
.SH 例
.PP
.\"O Granting an additional user read access
追加のユーザの読み込みアクセスを許可する。
.RS
.fam C
setfacl \-m u:lisa:r file
.fam T
.RE
.PP
.\"O Revoking write access from all groups and all named users (using the effective rights mask)
全てのグループと全ての指名ユーザの書き込みアクセスを
(実効権マスクを使って) 取り消す。
.RS
.fam C
setfacl \-m m::rx file
.fam T
.RE
.PP
.\"O Removing a named group entry from a file's ACL
ファイルの ACL から指名グループエントリを削除する。
.RS
.fam C
setfacl \-x g:staff file
.fam T
.RE
.PP
.\"O Copying the ACL of one file to another
あるファイルの ACL を他にコピーする。
.RS
.fam C
getfacl file1 | setfacl \-\-set-file=\- file2
.fam T
.RE
.PP
.\"O Copying the access ACL into the Default ACL
アクセス ACL をデフォルト ACL にコピーする。
.RS
.fam C
getfacl \-\-access dir | setfacl \-d \-M\- dir
.fam T
.RE
.\"O .SH CONFORMANCE TO POSIX 1003.1e DRAFT STANDARD 17
.SH POSIX 1003.1e DRAFT STANDARD 17 への準拠
.\"O If the environment variable POSIXLY_CORRECT is defined, the default behavior of setfacl changes as follows: All non-standard options are disabled.
環境変数 POSIXLY_CORRECT が定義されている場合、
getfacl のデフォルトの動作は、以下のように変わる。
標準に準拠しない全てのオプションは無効にされる。
.\"O The ``default:'' prefix is disabled.
``default:'' プレフィックスは無効にされる。
.\"O The
.\"O .IR \-x " and " \-X
.\"O options also accept permission fields (and ignore them). 
.IR \-x " と " \-X
オプションは許可フィールドを受け付ける (しかし、無視する)。
.\"O .SH AUTHOR
.SH 著者
Andreas Gruenbacher,
.RI < a.gruenbacher@bestbits.at >.

.\"O Please send your bug reports, suggested features and comments to the
.\"O above address.
バグ報告・提案したい機能・意見は上記のアドレスに送ってほしい。
.\"O .SH SEE ALSO
.SH 関連項目
.BR getfacl "(1), " chmod "(1), " umask "(1), " acl (5)
