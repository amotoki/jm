.\" .Id $Id: at.1,v 1.4 2003/12/16 13:28:25 nakano Exp $
.\"
.\" Original man-page is part of at-3.1.7.
.\"
.\" Copyright: 1993, 1994, 1995, 1996, 1997 (c) Thomas Koenig
.\"            1993 (c) David Parsons
.\" 
.\" This program is distributed in the hope that it will be useful, but
.\" WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" General Public License for more details.
.\"
.\" Japanese Version Copyright (c) 1996 Tanoshima Hidetohsi
.\"         all rights reserved.
.\" Dec 31, 1996   Tanoshima Hidetoshi <tano@sainet.or.jp> 
.\"
.\" Modified to reflect changes at-3.1.7
.\" Mon 22 Jun 1998, by NAKANO Takeo <nakano@apm.seikei.ac.jp>
.\"
.\" Modified to fix two errors(section name, OKURI-GANA)
.\" Mon 9 Aug 1999, by FUJIWARA Teruyoshi <fujiwara@linux.or.jp>
.\"
.TH AT 1 "Nov 1996" local "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O at, batch, atq, atrm \- queue, examine or delete jobs for later execution
at, batch, atq, atrm \- 後で実行するコマンドジョブをキューに入れたり、そのようなジョブの閲覧・削除を行なう
.SH 書式
.B at
.RB [ -V ]
.RB [ -q 
.IR queue ]
.RB [ -f
.IR file ]
.RB [ -mldbv ]
.B TIME
.br
.B "at -c"
.I job
.RI [ job... ]
.br
.B atq
.RB [ -V ]
.RB [ -q
.IR queue ]
.RB [ -v ]
.br
.B atrm
.RB [ -V ]
.I job
.RI [ job... ]
.br
.B batch
.RB [ -V ]
.RB [ -q
.IR queue ]
.RB [ -f
.IR file ]
.RB [ -mv ]
.RB [ TIME ]
.\"O .SH DESCRIPTION
.SH 解説
.\"O .B at
.\"O and
.\"O .B batch
.\"O read commands from standard input or a specified file which are to
.\"O be executed at a later time, using
.\"O .BR /bin/sh .
.B at
と
.B batch
は、標準入力や指定されたファイルからコマンドを読み取り、後で
.BR /bin/sh
を使って実行する。
.TP 8
.BR at
.\"O executes commands at a specified time.
指定された時刻にコマンドを実行する。
.TP 8
.BR atq
.\"O lists the user's pending jobs, unless the user is the superuser; in that
.\"O case, everybody's jobs are listed.
このコマンドを起動したユーザーの、実行されていないジョブを表
示する。スーパーユーザーで起動すると、全てのユーザー
のジョブを表示する。
.TP 8
.BR atrm
.\"O deletes jobs.
ジョブを削除する。
.TP 8
.BR batch
.\"O executes commands when system load levels permit; in other words, when the load average
.\"O drops below 0.8, or the value specified in the invocation of
.\"O .BR atrun .
システムの負荷レベルが許可したときコマンドを実行する。
すなわち、負荷平均が 0.8 か、または
.B atrun
で指定された値を下回るとコマンドを実行する。
.PP
.\"O .B At
.\"O allows fairly complex time
.\"O specifications, extending the POSIX.2 standard.  It accepts times
.\"O of the form 
.\"O .B HH:MM
.\"O to run a job at a specific time of day.
.\"O (If that time is already past, the next day is assumed.)
.B at
ではある程度複雑な
.B TIME
指定ができる。これは POSIX.2 標準を拡張したものである。
ジョブを実行する時刻は
.B HH:MM
という形式で指定できる。
(すでにその時刻を過ぎているときは次の日に実行する。)
.\"O You may also specify
.\"O .B midnight,
.\"O .B noon,
.\"O or
.\"O .B teatime
.\"O (4pm)
.\"O and you can have a time-of-day suffixed with
.\"O .B AM
.\"O or
.\"O .B PM
.\"O for running in the morning or the evening.
また
.B midnight
(真夜中),
.B noon
(正午),
.B teatime
(午後４時のお茶の時間)
とか、
.B AM
,
.B PM
も指定できる。
.\"O You can also say what day the job will be run,
.\"O by giving a date in the form
.\"O .B month-name
.\"O .B day
.\"O with an optional
.\"O .B year,
.\"O or giving a date of the form
.\"O .B MMDDYY
.\"O or
.\"O .B MM/DD/YY
.\"O or
.\"O .B DD.MM.YY.
さらに、コマンドの実行日を指定することもできる。
日付の指定は
.B month-name
.B day
(
.B year
も追加できる) のようにする。または
.BR MMDDYY ,
.BR MM/DD/YY ,
.B DD.MM.YY
なども可能である。
.\"O The specification of a date
.\"O .I must
.\"O follow the specification of the time of day.
日付の指定は、その日の時刻の\fI後に\fP指定しなければならない。
.\"O You can also give times like
.\"O .B now
.\"O .B \+
.\"O .I count
.\"O .I time-units,
.\"O where the time-units can be
.\"O .B minutes,
.\"O .B hours,
.\"O .B days,
.\"O or
.\"O .B weeks
.\"O and you can tell
.\"O .B at
.\"O to run the job today by suffixing the time with
.\"O .B today
.\"O and to run the job tomorrow by suffixing the time with
.\"O .B tomorrow.
また
.B now
.B \+
.I count
.I time-units,
と指定することでコマンドをどのくらい後に実行するか指定できる。
時間の単位には
.B minutes,
.B hours,
.B days,
.B weeks
が使える。
さらにジョブを今日実行したい場合は
.B today
を、明日実行したい場合は
.B tomorrow
を、それぞれ時刻の後に付ければ良い。
.PP
.\"O For example, to run a job at 4pm three days from now, you would do
.\"O .B at 4pm + 3 days,
.\"O to run a job at 10:00am on July 31, you would do
.\"O .B at 10am Jul 31
.\"O and to run a job at 1am tomorrow, you would do
.\"O .B at 1am tomorrow.
例えば、今日から 3 日後の午後 4 時にジョブを実行する場合
.B at 4pm + 3 days,
とし、 7 月 31 日の午前 10 時にジョブを実行するときは
.B at 10am Jul 31
とし、明日の午前 1 時に実行するときは
.B at 1am tomorrow
とする。
.PP
.\"O The exact definition of the time specification can be found in
.\"O .IR /usr/doc/at/timespec .
時間指定方法の厳密な定義は
.I /usr/doc/at/timespec
に書いてある。
.PP
.\"O For both
.\"O .BR at " and " batch ,
.\"O commands are read from standard input or the file specified
.\"O with the
.\"O .B -f
.\"O option and executed.
.BR at " と " batch
は、ともに標準入力や
.B -f
オプションで指定されたファイルのコマンドを実行する。
.\"O The working directory, the environment (except for the variables
.\"O .BR TERM ,
.\"O .BR DISPLAY
.\"O and
.\"O .BR _ )
.\"O and the umask are retained from the time of invocation.
作業ディレクトリ、環境 (環境変数
.BR TERM ", " DISPLAY ", " _
を除く)、 umask には、
.BR at " や " batch
が起動されたときのものが保存される。
.\"O An
.\"O .BR "at " \-
.\"O or
.\"O .BR "batch "\-
.\"O command invoked from a 
.\"O .B su(1)
.\"O shell will retain the current userid.
.B su(1)
したあとのシェルから起動された
.B at 
(または
.BR "batch " )
コマンドでは、カレントのユーザー ID が用いられる。
.\"O The user will be mailed standard error and standard output from his
.\"O commands, if any.
コマンドを実行した結果、標準エラー出力や標準出力が出ると、ユーザー
はメールを受け取る。
.\"O Mail will be sent using the command
.\"O .BR /usr/sbin/sendmail .
メールの配送には
.BR /usr/bin/sendmail
が用いられる。
.\"O If
.\"O .B at
.\"O is executed from a 
.\"O .B su(1)
.\"O shell, the owner of the login shell will receive the mail.
.B at
が
.B su(1)
したあとのシェルから起動されたときは、ログインシェルのオーナーがメール
を受け取る。
.PP
.\"O The superuser may use these commands in any case.
.\"O For other users, permission to use at is determined by the files
.\"O .I /etc/at.allow
.\"O and
.\"O .IR /etc/at.deny .
スーパーユーザーは、どんな場合でも必ずこのコマンドを使うことができる。
他のユーザーのパーミッションは
.I /etc/at.allow
と
.I /etc/at.deny
で指定する。
.PP
.\"O If the file
.\"O .I /etc/at.allow
.\"O exists, only usernames mentioned in it are allowed to use
.\"O .BR at .
.I /etc/at.allow
があれば、そこに書かれたユーザーのみが
.BR at
を使える。
.PP
.\"O If
.\"O .I /etc/at.allow
.\"O does not exist,
.\"O .I /etc/at.deny
.\"O is checked, every username not mentioned in it is then allowed
.\"O to use
.\"O .BR at .
.I /etc/at.allow
がなければ
.I /etc/at.deny
をチェックし、そこに書かれて「いない」ユーザーすべてが
.B at
を使える。
.PP
.\"O If neither exists, only the superuser is allowed use of at.
もしどちらのファイルもなければ、スーパーユーザーのみ
at を使うことができる。
.PP
.\"O An empty 
.\"O .I /etc/at.deny
.\"O means that every user is allowed use these commands, this is the
.\"O default configuration.
空の 
.I /etc/at.deny
があるときは、全てのユーザーがこれらのコマンドを使うことができる。
この設定がデフォルトである。
.\"O .SH OPTIONS
.SH オプション
.TP 8
.B -V
.\"O prints the version number to standard error.
バージョン情報を標準エラー出力に表示する。
.TP 8
.BI \-q " queue"
.\"O uses the specified queue.
.\"O A queue designation consists of a single letter; valid queue designations
.\"O range from
.\"O .B a
.\"O to 
.\"O .BR z .
.\"O and
.\"O .B A
.\"O to
.\"O .BR Z .
キュー指定をする。指定は英字１文字で行う。
有効な文字は
.B a
から 
.BR z
と
.B A
から
.BR Z
である。
.\"O The
.\"O .B a
.\"O queue is the default for
.\"O .B at
.\"O and the
.\"O .B b
.\"O queue for
.\"O .BR batch .
.B a
キューが
.B at
のデフォルトキューで、
.B b
キューが
.BR batch
のデフォルトキューである。
.\"O Queues with higher letters run with increased niceness.  The special
.\"O queue "=" is reserved for jobs which are currently running.
後のほうの文字のキューほど、より nice レベルが大きくなる
(実行の優先度が下がる)。特殊キュー "=" は現在実行されているジョブのため
に予約されている。

.\"O If a job is submitted to a queue designated with an uppercase letter, it
.\"O is treated as if it had been submitted to batch at that time.
大文字のキューで予約されたジョブは、 batch で指定されたかのよう
に扱われる。
.\"O If
.\"O .BR atq
.\"O is given a specific queue, it will only show jobs pending in that queue.
.BR atq
でキューを指定すると、そのキューにたまっている
未実行ジョブだけを表示する。
.TP 8
.B \-m
.\"O Send mail to the user when the job has completed even if there was no
.\"O output.
ジョブが完了したとき、そのジョブがなにも出力しなくても、
ユーザーに完了通知をメールする。
.TP 8
.BI \-f " file"
.\"O Reads the job from
.\"O .BI file
.\"O rather than standard input.
標準入力でなく、
.I file
からジョブを読み取る。
.TP 8
.B \-l
.\"O Is an alias for
.\"O .B atq.
.B atq
と同じ働きをする。
.TP
.B \-d
.\"O Is an alias for
.\"O .B atrm.
.B atrm
と同じ働きをする。
.\"O .TP
.\"O .B \-v
.\"O For
.\"O .BR atq ,
.\"O shows completed but not yet deleted jobs in the queue; otherwise
.\"O shows the time the job will be executed.
.BR atq
で指定された場合には、キューの中に存在している「終了したがまだ削除され
ていない」ジョブを表示する。そのほかのコマンドで指定された場合は、その
ジョブを実行する時刻を表示する。

.\"O Times displayed will be in the format "1997-02-20 14:50" unless the
.\"O environment variable
.\"O .B POSIXLY_CORRECT 
.\"O is set; then, it will be "Thu Feb 20 14:50:00 1996".
時刻は "1997-02-20 14:50" のような形式で表示される。ただし環境変数
.B POSIXLY_CORRECT
が指定されている場合は "Thu Feb 20 14:50:00 1996" のようになる。
.TP
.B
\-c
.\"O cats the jobs listed on the command line to standart output.
コマンドラインで指定したジョブを標準出力に表示する。
.\"O .SH FILES
.SH ファイル
.I /var/spool/atjobs
.br
.I /var/spool/atspool
.br
.I /proc/loadavg
.br
.I /var/run/utmp
.br
.I /etc/at.allow
.br
.I /etc/at.deny
.\"O .SH SEE ALSO
.SH 関連項目
cron(1), nice(1), sh(1), umask(2), atd(8)
.\"O .SH BUGS
.SH バグ
.\"O The correct operation of
.\"O .B batch
.\"O for Linux depends on the presence of a
.\"O .IR proc -
.\"O type directory mounted on
.\"O .IR /proc .
Linux で
.B batch
が正しく動作するためには、
.IR /proc
にマウントされた
.IR proc
形式のディレクトリが必要である。
.PP
.\"O If the file
.\"O .I /var/run/utmp
.\"O is not available or corrupted, or if the user is not logged on at the
.\"O time 
.\"O .B at
.\"O is invoked, the mail is sent to the userid found
.\"O in the environment variable
.\"O .BR LOGNAME .
.\"O If that is undefined or empty, the current userid is assumed.
もし
.I /etc/utmp
が壊れて使えなかったり、
.B at
がジョブを実行するときにユーザーがログインしてなかったりすると、
環境変数
.BR LOGNAME
で指定されたユーザー ID にメールを送る。もしこの変数が定義されて
いなかったり、空だったりした場合、カレントのユーザー ID に送られる。
.PP
.\"O .B At
.\"O and
.\"O .B batch
.\"O as presently implemented are not suitable when users are competing for
.\"O resources.
.\"O If this is the case for your site, you might want to consider another
.\"O batch system, such as
.\"O .BR nqs .
.B at
と
.B batch
の現在の実装は、ユーザーが資源を取り合っているような状況下では
適当なものではない。このような場合は他のbatchシステム、たとえば
.BR nqs
などを考えるべきだろう。
.\"O .SH AUTHOR
.SH 著者
.\"O At was mostly written by Thomas Koenig, ig25@rz.uni-karlsruhe.de.
at はほぼ Thomas Koenig, ig25@rz.uni-karlsruhe.de によって書かれた。

