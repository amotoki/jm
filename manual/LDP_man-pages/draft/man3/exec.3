.\" Copyright (c) 1991 The Regents of the University of California.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @(#)exec.3	6.4 (Berkeley) 4/19/91
.\"
.\" Converted for Linux, Mon Nov 29 11:12:48 1993, faith@cs.unc.edu
.\" Updated more for Linux, Tue Jul 15 11:54:18 1997, pacman@cqc.com
.\" Modified, 24 Jun 2004, Michael Kerrisk <mtk.manpages@gmail.com>
.\"     Added note on casting NULL
.\"
.\" Japanese Version Copyright (c) 1998 Masato Taruishi
.\"         all rights reserved.
.\" Translated 1998-05-27, Masato Taruishi
.\" Modified 1998-08-08, Fujiwara Teruyoshi <fujiwara@linux.or.jp>
.\" Modified 2000-10-06, Kentaro Shirakata <argrath@ub32.org>
.\" Modified 2005-02-26, Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>
.\"
.\"WORD:        null-terminated strings    NULLで終わる文字列
.\"WORD:        anti-Trojan-horse measure  トロイの木馬対策
.\"WORD:	external variable          外部変数
.\"WORD:        current  directory first   カレントディレクトリが最初
.\"WORD:        the attempted execve       呼び出そうとしたexecve
.\"WORD:        variadic function          可変長引き数関数
.\"WORD:        semantics                  (プログラムの)動作
.\"
.TH EXEC 3  2009-02-22 "GNU" "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O execl, execlp, execle, execv, execvp \- execute a file
execl, execlp, execle, execv, execvp \- ファイルを実行する
.\"O .SH SYNOPSIS
.SH 書式
.B #include <unistd.h>
.sp
.B extern char **environ;
.sp
.BI "int execl(const char *" path ", const char *" arg ", ...);"
.br
.BI "int execlp(const char *" file ", const char *" arg ", ...);"
.br
.BI "int execle(const char *" path ", const char *" arg ,
.br
.BI "           ..., char * const " envp "[]);"
.br
.BI "int execv(const char *" path ", char *const " argv "[]);"
.br
.BI "int execvp(const char *" file ", char *const " argv "[]);"
.\"O .SH DESCRIPTION
.SH 説明
.\"O The
.\"O .BR exec ()
.\"O family of functions replaces the current process image with a new process
.\"O image.
.\"O The functions described in this manual page are front-ends for
.\"O .BR execve (2).
.\"O (See the manual page for
.\"O .BR execve (2)
.\"O for further details about the replacement of the current process image.)
.BR exec ()
ファミリーの関数は現在のプロセスイメージを新しいプロセスイメージで置き
換える。このマニュアルで説明されている関数は
.BR execve (2)
のフロントエンドである。
(現在のプロセスイメージの置き換えについての詳細は
.BR execve (2)
のマニュアルを参照)
.PP
.\"O The initial argument for these functions is the pathname of a file which is
.\"O to be executed.
これらの関数の最初の引き数は、実行されるファイルのパス名である。
.PP
.\"O The
.\"O .I "const char *arg"
.\"O and subsequent ellipses in the
.\"O .BR execl (),
.\"O .BR execlp (),
.\"O and
.\"O .BR execle ()
.\"O functions can be thought of as
.\"O .IR arg0 ,
.\"O .IR arg1 ,
.\"O \&...,
.\"O .IR argn .
関数
.BR execl (),
.BR execlp (),
.BR execle ()
の
.I "const char *arg"
とそれに続く省略部分は
.IR arg0 ,
.IR arg1 ,
\&...,
.I argn
とみなされる。
.\"O Together they describe a list of one or more pointers to null-terminated
.\"O strings that represent the argument list available to the executed program.
.\"O The first argument, by convention, should point to the filename associated
.\"O with the file being executed.
.\"O The list of arguments
.\"O .I must
.\"O be terminated by a NULL
.\"O pointer, and, since these are variadic functions, this pointer must be cast
.\"O .IR "(char *) NULL" .
これらには、実行されるプログラムで利用可能な引き数のリストを指定する
(引き数のリストは NULL で終端された文字列へのポインタから構成される)。
慣習として、最初の引き数は、実行されるファイル名
へのポインタにする。引き数のリストは必ず NULL
で終わらなければならず、これらの関数は可変長引き数関数なので、
このポインタは
.I "(char *) NULL"
とキャストしなければならない。
.PP
.\"O The
.\"O .BR execv ()
.\"O and
.\"O .BR execvp ()
.\"O functions provide an array of pointers to null-terminated strings that
.\"O represent the argument list available to the new program.
.\"O The first argument, by convention, should point to the filename
.\"O associated with the file being executed.
.\"O The array of pointers
.\"O .I must
.\"O be terminated by a NULL pointer.
関数
.BR execv ()
と
.BR execvp ()
は、利用可能な引き数リスト (NULL で終端された文字列への
ポインタの配列) を新しいプログラムに渡す。
慣習として、最初の引き数は実行されるファイル名へ
のポインタにする。ポインタの配列は必ず
NULL で終わらなければならない。
.PP
.\"O The
.\"O .BR execle ()
.\"O function also specifies the environment of the executed process by following
.\"O the NULL
.\"O pointer that terminates the list of arguments in the argument list or the
.\"O pointer to the
.\"O .I argv
.\"O array with an additional argument.
.\"O This additional
.\"O argument is an array of pointers to null-terminated strings and
.\"O .I must
.\"O be terminated by a NULL pointer.
.\"O The other functions take the environment for the new process
.\"O image from the external variable
.\"O .I environ
.\"O in the current process.
関数
.BR execle ()
では新しいプロセスの環境も指定する。
環境は引き数リスト (引き数リストもしくは追加の引き数を持った
.I argv
配列へのポインタ) の最後の NULL ポインタに続けて指定する。
追加の引き数は、NULL で終端された文字列へのポインタの配列であり、
NULL ポインタで終わらなければならない。
他の関数では、現在のプロセスの外部変数
.B environ
から新しいプロセス用の環境を与える。
.\"O .SS Special semantics for execlp() and execvp()
.SS execlp() と execvp() の特別な動作
.PP
.\"O The functions
.\"O .BR execlp ()
.\"O and
.\"O .BR execvp ()
.\"O will duplicate the actions of the shell in searching for an executable file
.\"O if the specified filename does not contain a slash (/) character.
.\"O The search path is the path specified in the environment by the
.\"O .B PATH
.\"O variable.
.\"O If this variable isn't specified, the default path
.\"O ":/bin:/usr/bin" is used.
.\"O In addition, certain
.\"O errors are treated specially.
関数
.BR execlp ()
と
.BR execvp ()
は、指定されたファイル名がスラッシュ (/) を含んでいない場合、
シェルと同じ動作で実行可能なファイルを探索する。
検索パスは環境変数
.B PATH
で指定されたパスである。
この変数が指定されていない場合、デフォルトPATHとして
":/bin:/usr/bin" が使用される。
また、いくつかのエラーが発生した場合の扱いが特殊である。
.PP
.\"O If permission is denied for a file (the attempted
.\"O .BR execve (2)
.\"O failed with the error
.\"O .BR EACCES ),
.\"O these functions will continue searching the rest of the search path.
.\"O If no other file is found, however,
.\"O they will return with
.\"O .I errno
.\"O set to
.\"O .BR EACCES .
もしファイルが実行ファイルでない場合 (このとき呼び出そうとした
.BR execve (2)
はエラー
.B EACCES
で失敗する)、これらの関数は残りの検索パスの検索を続ける。
他にファイルが見つからなくなった場合
.I errno
に
.B EACCES
を設定し復帰する。
.\" fujiwara: 個人的には「復帰する」の方が好き(^_^;
.PP
.\"O If the header of a file isn't recognized (the attempted
.\"O .BR execve (2)
.\"O failed with the error
.\"O .BR ENOEXEC ),
.\"O these functions will execute the shell
.\"O .RI ( /bin/sh )
.\"O with the path of the file as its first argument.
.\"O (If this attempt fails, no further searching is done.)
ファイルのヘッダが実行形式として認識できない場合
(このとき呼び出そうとした
.BR execve (2)
はエラー
.B ENOEXEC
で失敗する)、これらの関数はそのファイルを最初の引き数としたシェル
.RI ( /bin/sh )
を実行する (これにも失敗した場合、これ以上の検索は行われない)。
.\"O .SH "RETURN VALUE"
.SH 返り値
.\"O If any of the
.\"O .BR exec ()
.\"O functions returns, an error will have occurred.
.\"O The return value is \-1, and
.\"O .I errno
.\"O will be set to indicate the error.
もし
.BR exec ()
ファミリーが復帰してきた場合、エラーが発生している。
返り値は \-1 で、
.I errno
にそのエラーの内容がセットされる。
.\"O .SH ERRORS
.SH エラー
.\"O All of these functions may fail and set
.\"O .I errno
.\"O for any of the errors specified for the library function
.\"O .BR execve (2).
これら全ての関数は失敗する場合がある。その場合ライブラリ関数
.BR execve (2)
によって指定されたエラーを
.I errno
に設定する。
.\"O .SH "CONFORMING TO"
.SH 準拠
POSIX.1-2001.
.\"O .SH NOTES
.SH 注意
.\"O On some other systems the default path (used when the environment
.\"O does not contain the variable \fBPATH\fR) has the current working
.\"O directory listed after
.\"O .I /bin
.\"O and
.\"O .IR /usr/bin ,
.\"O as an anti-Trojan-horse measure.
.\"O Linux uses here the
.\"O traditional "current directory first" default path.
Linux 以外のシステムには、
(環境変数 \fBPATH\fR が定義されていないときの)
デフォルトのパスにおいて、カレント・ディレクトリが
.I /bin
と
.I /usr/bin
の後ろに配置されるものもある。
これはトロイの木馬対策のためである。
Linux では、デフォルトのパスに、昔ながらの「現在のディレクトリを
先に探索」というルールを使っている。
.PP
.\"O The behavior of
.\"O .BR execlp ()
.\"O and
.\"O .BR execvp ()
.\"O when errors occur while attempting to execute the file is historic
.\"O practice, but has not traditionally been documented and is not specified by
.\"O the POSIX standard.
.\"O BSD (and possibly other systems) do an automatic
.\"O sleep and retry if
.\"O .B ETXTBSY
.\"O is encountered.
.\"O Linux treats it as a hard
.\"O error and returns immediately.
ファイルを実行しようとしている間にエラーが発生した時の
.BR execlp ()
と
.BR execvp ()
のふるまいについて歴史的な慣習はあるが、伝統的に文書として記載されておらず、
POSIX 標準でも規定されていない。BSD (またおそらく他のシステム) では、
.B ETXTBSY
が発生した場合、自動的に中断 (sleep) し再試行を行う。
Linux はそれをハードエラーとして取り扱い即座に復帰する。
.PP
.\"O Traditionally, the functions
.\"O .BR execlp ()
.\"O and
.\"O .BR execvp ()
.\"O ignored all errors except for the ones described above and
.\"O .B ENOMEM
.\"O and
.\"O .BR E2BIG ,
.\"O upon which they returned.
.\"O They now return if any error other than the ones
.\"O described above occurs.
伝統的に、関数
.BR execlp ()
と
.BR execvp ()
は、上で説明したエラーと、これら 2 つの関数自身が返す
.B ENOMEM
と
.B E2BIG
以外の全てのエラーを無視していたが、
今では、上で説明した以外のエラーが発生した場合でも、
返ってくるよう変更された。
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR sh (1),
.BR execve (2),
.BR fork (2),
.BR ptrace (2),
.BR fexecve (3),
.BR environ (7)
