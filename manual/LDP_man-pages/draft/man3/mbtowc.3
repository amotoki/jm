.\" Copyright (c) Bruno Haible <haible@clisp.cons.org>
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" References consulted:
.\"   GNU glibc-2 source code and manual
.\"   Dinkumware C library reference http://www.dinkumware.com/
.\"   OpenGroup's Single UNIX specification http://www.UNIX-systems.org/online.html
.\"   ISO/IEC 9899:1999
.\"
.\" Japanese Version Copyright (c) 1999 HANATAKA Shinya
.\"         all rights reserved.
.\" Translated Tue Jan 11 00:56:02 JST 2000
.\"         by HANATAKA Shinya <hanataka@abyss.rim.or.jp>
.\"
.TH MBTOWC 3  2001-07-04 "GNU" "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O mbtowc \- convert a multibyte sequence to a wide character
mbtowc \- マルチバイト列をワイド文字に変換する
.\"O .SH SYNOPSIS
.SH 書式
.nf
.B #include <stdlib.h>
.sp
.BI "int mbtowc(wchar_t *" pwc ", const char *" s ", size_t " n );
.fi
.\"O .SH DESCRIPTION
.SH 説明
.\"O The main case for this function is when \fIs\fP is not NULL and \fIpwc\fP is
.\"O not NULL.
.\"O In this case, the
.\"O .BR mbtowc ()
.\"O function inspects at most \fIn\fP
.\"O bytes of the multibyte string starting at \fIs\fP,
.\"O extracts the next complete
.\"O multibyte character, converts it to a wide character and stores it at
.\"O \fI*pwc\fP.
.\"O It updates an internal shift state only known to the mbtowc
.\"O function.
.\"O If \fIs\fP does not point to a \(aq\\0\(aq byte, it returns the number
.\"O of bytes that were consumed from \fIs\fP, otherwise it returns 0.
この関数が用いられる場合、通常 \fIs\fP が NULL でなく \fIpwc\fP も NULL
でない。この場合は
.BR mbtowc ()
関数は \fIs\fP から始まる
最大 \fIn\fP バイトのマルチバイト文字列を検査して、次の完全なマルチバイト
文字を取り出し、それをワイド文字に変換して \fI*pwc\fP に格納する。
同時に mbtowc 関数のみが使用する内部状態を更新する。\fIs\fP が \(aq\\0\(aq
以外のバイトを指している場合は、\fIs\fP から消費するバイト数を返す。
\fIs\fP が \(aq\\0\(aq を指している場合には 0 を返す。
.PP
.\"O If the \fIn\fP bytes starting at \fIs\fP do not contain a complete multibyte
.\"O character, or if they contain an invalid multibyte sequence,
.\"O .BR mbtowc ()
.\"O returns \-1.
.\"O This can happen even if \fIn\fP >= \fIMB_CUR_MAX\fP,
.\"O if the multibyte string contains redundant shift sequences.
\fIs\fP から始まる \fIn\fP バイトが完全なマルチバイト文字を含んで
いない場合や不正なマルチバイト列を含んでいる場合には
.BR mbtowc ()
は
\-1 を返す。マルチバイト文字列に冗長なシフトシーケンスが
含まれていると \fIn\fP >= \fIMB_CUR_MAX\fP の場合もこのようなことが
起こりえる。
.PP
.\"O A different case is when \fIs\fP is not NULL but \fIpwc\fP is NULL.
.\"O In this
.\"O case the
.\"O .BR mbtowc ()
.\"O function behaves as above, except that it does not
.\"O store the converted wide character in memory.
\fIs\fP が NULL でなく \fIpwc\fP が NULL の場合は
.BR mbtowc ()
関数は
上記と同様に動作するが、変換したワイド文字はメモリには書き込まれない。
.PP
.\"O A third case is when \fIs\fP is NULL.
.\"O In this case, \fIpwc\fP and \fIn\fP are
.\"O ignored.
.\"O The
.\"O .BR mbtowc ()
.\"O function
.\" The Dinkumware doc and the Single UNIX specification say this, but
.\" glibc doesn't implement this.
.\"O resets the shift state, only known to this function,
.\"O to the initial state, and
.\"O returns nonzero if the encoding has nontrivial shift state, or zero if the
.\"O encoding is stateless.
三番目の場合として \fIs\fP が NULL の場合は \fIpwc\fP と \fIn\fP は
無視される。
.BR mbtowc ()
関数のみが使用するシフト状態は初期状態に
戻される。そして文字符号がシフト状態に依存するならばゼロ以外を、文字符号が
状態によらないならばゼロを返す。
.\"O .SH "RETURN VALUE"
.SH 返り値
.\"O If \fIs\fP is not NULL, the
.\"O .BR mbtowc ()
.\"O function returns the number of
.\"O consumed bytes starting at \fIs\fP, or 0 if \fIs\fP points to a null byte,
.\"O or \-1 upon failure.
\fIs\fP が NULL でなければ
.BR mbtowc ()
関数は \fIs\fP から消費した
バイト数を、\fIs\fP がナル文字を指している場合はゼロを、
変換に失敗した場合は \-1 を返す。
.PP
.\"O If \fIs\fP is NULL, the
.\"O .BR mbtowc ()
.\"O function
.\"O returns nonzero if the encoding
.\"O has nontrivial shift state, or zero if the encoding is stateless.
\fIs\fP が NULL ならば
.BR mbtowc ()
関数は文字符号がシフト状態に依存
していればゼロ以外を、状態によらなければゼロを返す。
.\"O .SH "CONFORMING TO"
.SH 準拠
C99.
.\"O .SH NOTES
.SH 注意
.\"O The behavior of
.\"O .BR mbtowc ()
.\"O depends on the
.\"O .B LC_CTYPE
.\"O category of the
.\"O current locale.
.BR mbtowc ()
の動作は現在のロケールの
.B LC_CTYPE
カテゴリに依存している。
.PP
.\"O This function is not multithread safe.
.\"O The function
.\"O .BR mbrtowc (3)
.\"O provides
.\"O a better interface to the same functionality.
この関数はマルチスレッドでは安全ではない。
.BR mbrtowc (3)
関数は
同じ機能のより良いインターフェースを提供する。
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR MB_CUR_MAX (3),
.BR mbrtowc (3),
.BR mbstowcs (3)
