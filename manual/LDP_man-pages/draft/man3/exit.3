.\" Copyright (C) 2001 Andries Brouwer <aeb@cwi.nl>.
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one.
.\"
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\"
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Japanese Version Copyright (c) 1997 HORIMOTO Masafumi
.\"         all rights reserved.
.\" Translated 1997-09-10, HORIMOTO Masafumi
.\" Updated & Modified 2001-10-27, Yuichi SATO <ysato@h4.dion.ne.jp>
.\" Updated & Modified 2001-12-09, Yuichi SATO
.\" Updated & Modified 2005-09-06, Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>
.\" Updated 2007-06-18, Akihiro MOTOKI, LDP v2.57
.\"
.TH EXIT 3  2009-09-20 "Linux" "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O exit \- cause normal process termination
exit \- プロセスの正常終了
.\"O .SH SYNOPSIS
.SH 書式
.nf
.B #include <stdlib.h>
.sp
.BI "void exit(int " status );
.fi
.\"O .SH DESCRIPTION
.SH 説明
.\"O The
.\"O .BR exit ()
.\"O function causes normal process termination and the
.\"O value of \fIstatus & 0377\fP is returned to the parent
.\"O (see
.\"O .BR wait (2)).
.BR exit ()
関数は、プロセスを正常に終了させ、
\fIstatus & 0377\fP という値を親プロセスへ返す
.RB ( wait (2)
を参照)。
.LP
.\"O All functions registered with
.\"O .BR atexit (3)
.\"O and
.\"O .BR on_exit (3)
.\"O are called, in the reverse order of their registration.
.\"O (It is possible for one of these functions to use
.\"O .BR atexit (3)
.\"O or
.\"O .BR on_exit (3)
.\"O to register an additional
.\"O function to be executed during exit processing;
.\"O the new registration is added to the front of the list of functions
.\"O that remain to be called.)
.BR atexit (3)
や
.BR on_exit (3)
によって
登録された全ての関数は、それらが登録された順番と逆順にコールされる。
(登録された関数の中で
.BR atexit (3)
or
.BR on_exit (3)
を使って
exit 処理中に実行される追加の関数を登録することができる;
新規に登録された関数は、この後で実行される関数リストの先頭に
追加される。)
.\"O If one of these functions does not return
.\"O (e.g., it calls
.\"O .BR _exit (2),
.\"O or kills itself with a signal),
.\"O then none of the remaining functions is called,
.\"O and further exit processing (in particular, flushing of
.\"O .BR stdio (3)
.\"O streams) is abandoned.
.\"O If a function has been registered multiple times using
.\"O .BR atexit (3)
.\"O or
.\"O .BR on_exit (3),
.\"O then it is called as many times as it was registered.
これらの関数の一つが返らなかった場合
(例えば、その関数が
.BR _exit (2)
を呼び出したり、シグナルで自分自身を kill した場合)、
残りの関数はどれも呼び出されず、それ以降の exit 処理
(特に
.BR stdio (3)
ストリームのフラッシュなど) は中止される。
ある関数が
.BR atexit (3)
や
.BR on_exit (3)
を使って複数回登録されていた場合、
その関数は登録されたのと同じ回数だけ呼び出される。
.LP
.\"O All open
.\"O .BR stdio (3)
.\"O streams are flushed and closed.
.\"O Files created by
.\"O .BR tmpfile (3)
.\"O are removed.
オープン中の
.BR stdio (3)
ストリームは全てフラッシュされて、クローズされる。
.BR tmpfile (3)
によって作成されたファイルは削除される。
.LP
.\"O The C standard specifies two constants,
.\"O \fBEXIT_SUCCESS\fP and \fBEXIT_FAILURE\fP,
.\"O that may be passed to
.\"O .BR exit ()
.\"O to indicate successful or unsuccessful
.\"O termination, respectively.
C 標準では
.B EXIT_SUCCESS
と
.B EXIT_FAILURE
という 2つの定数が
定義されている。それぞれ正常終了と異常終了を示すもので、
.BR exit ()
として渡すことができる。
.\"O .SH "RETURN VALUE"
.SH 返り値
.\"O The
.\"O .BR exit ()
.\"O function does not return.
.BR exit ()
関数は返らない。
.\"O .SH "CONFORMING TO"
.SH 準拠
SVr4, 4.3BSD, POSIX.1-2001, C89, C99.
.\"O .SH NOTES
.SH 注意
.LP
.\"O It is undefined what happens if one of the
.\"O functions registered using
.\"O .BR atexit (3)
.\"O and
.\"O .BR on_exit (3)
.\"O calls either
.\"O .BR exit ()
.\"O or
.\"O .BR longjmp (3).
.BR atexit (3)
や
.BR on_exit (3)
を使って登録された関数の中で
.BR exit ()
か
.BR longjmp (3)
が呼び出された場合、
何が起こるかは未定義である。
.LP
.\"O The use of
.\"O .B EXIT_SUCCESS
.\"O and
.\"O .B EXIT_FAILURE
.\"O is slightly more portable
.\"O (to non-Unix environments) than the use of 0 and some nonzero value
.\"O like 1 or \-1.
.\"O In particular, VMS uses a different convention.
.B EXIT_SUCCESS
と
.B EXIT_FAILURE
を使うと、0 や (1 や \-1 といった) 0 以外の値を使うのに比べて
(Unix 以外の環境に) 移植するのがいくらか簡単になる。
特に VMS は別の方式を用いている。
.LP
.\"O BSD has attempted to standardize exit codes; see the file
.\"O .IR <sysexits.h> .
BSD は終了コードを標準化しようとしている;
.I <sysexits.h>
を参照すること。
.LP
.\"O After
.\"O .BR exit (),
.\"O the exit status must be transmitted to the
.\"O parent process.
.\"O There are three cases.
.\"O If the parent has set
.\"O .BR SA_NOCLDWAIT ,
.\"O or has set the
.\"O .B SIGCHLD
.\"O handler to
.\"O .BR SIG_IGN ,
.\"O the status is discarded.
.\"O If the parent was waiting on the child
.\"O it is notified of the exit status.
.\"O In both cases the exiting
.\"O process dies immediately.
.\"O If the parent has not indicated that
.\"O it is not interested in the exit status, but is not waiting,
.\"O the exiting process turns into a "zombie" process
.\"O (which is nothing but a container for the single byte representing
.\"O the exit status) so that the parent can learn the exit status when
.\"O it later calls one of the
.\"O .BR wait (2)
.\"O functions.
.BR exit ()
の後、親プロセスに終了ステータスが渡されなければならない。
終了ステータスの渡し方には 3 つの場合がある。
親プロセスが
.B SA_NOCLDWAIT
を設定した場合、
または
.B SIGCHLD
ハンドラを
.B SIG_IGN
に設定した場合、
ステータスは破棄される。
親プロセスが子プロセスの終了を待っている場合、
親プロセスに終了ステータスが伝えられる。
どちらの場合でも exit のプロセスは直ちに終了する。
「終了ステータスを関知せず終了も待たない」
ということを親プロセスが指示していない場合、
exit プロセスは (終了ステータスを表す 1 バイトのみを保持する)
「ゾンビ」プロセスになる。
これにより、後から
.BR wait (2)
関数を呼び出すことで、
親プロセスは終了ステータスを知ることができる。
.LP
.\"O If the implementation supports the
.\"O .B SIGCHLD
.\"O signal, this signal
.\"O is sent to the parent.
.\"O If the parent has set
.\"O .BR SA_NOCLDWAIT ,
.\"O it is undefined whether a
.\"O .B SIGCHLD
.\"O signal is sent.
.B SIGCHLD
シグナルのサポートが実装されている場合、
このシグナルは親プロセスに送られる。
親プロセスが
.B SA_NOCLDWAIT
を設定した場合、
.B SIGCHLD
シグナルが送られるかどうかは定義されていない。
.LP
.\"O If the process is a session leader and its controlling terminal
.\"O is the controlling terminal of the session, then each process in
.\"O the foreground process group of this controlling terminal
.\"O is sent a
.\"O .B SIGHUP
.\"O signal, and the terminal is disassociated
.\"O from this session, allowing it to be acquired by a new controlling
.\"O process.
そのプロセスがセッションのリーダーで、
そのプロセスの制御端末がそのセッションの制御端末である場合、
この制御端末のフォアグラウンドプロセスグループにある
各プロセスに
.B SIGHUP
シグナルが送られ、端末がセッションから切り離される。
これにより新しい制御プロセスを取得することができる。
.LP
.\"O If the exit of the process causes a process group to become orphaned,
.\"O and if any member of the newly orphaned process group is stopped,
.\"O then a
.\"O .B SIGHUP
.\"O signal followed by a
.\"O .B SIGCONT
.\"O signal will be
.\"O sent to each process in this process group.
プロセスが終了することにより、プロセスグループが孤立して、
そのグループのメンバーのうちのどれかが停止した場合、
プロセスグループの各プロセスに対して
.B SIGHUP
シグナルが送られ、続いて
.B SIGCONT
シグナルが送られる。
.\"O See
.\"O .BR setpgid (2)
.\"O for an explanation of orphaned process groups.
孤立した (orphaned) プロセスグループの説明は
.BR setpgid (2)
を参照。
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR _exit (2),
.BR setpgid (2),
.BR wait (2),
.BR atexit (3),
.BR on_exit (3),
.BR tmpfile (3)
