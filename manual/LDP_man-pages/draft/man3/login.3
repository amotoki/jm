.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139,
.\" USA.
.\"
.\" Derived from text written by Martin Schulze (or taken from glibc.info)
.\" and text written by Paul Thompson - both copyright 2002.
.\"
.\" Japanese Version Copyright (c) 2004-2005 Yuichi SATO
.\"         all rights reserved.
.\" Translated Thu Aug 26 06:04:53 JST 2004
.\"         by Yuichi SATO <ysato444@yahoo.co.jp>
.\" Updated & Modified Sat Jan 15 06:38:41 JST 2005 by Yuichi SATO
.\"
.TH LOGIN 3 2004-05-06 "GNU" "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O login, logout \- write utmp and wtmp entries
login, logout \- utmp と wtmp エントリを書き込む
.\"O .SH SYNOPSIS
.SH 書式
.B #include <utmp.h>
.sp
.BI "void login(const struct utmp *" ut );
.sp
.BI "int logout(const char *" ut_line );
.sp
.\"O Link with \fI\-lutil\fP.
\fI\-lutil\fP でリンクする。
.\"O .SH DESCRIPTION
.SH 説明
.\"O The utmp file records who is currently using the system.
utmp ファイルは現在システムを使用しているユーザを記録する。
.\"O The wtmp file records all logins and logouts.
.\"O See
.\"O .BR utmp (5).
wtmp ファイルはすべてのログインとログアウトを記録する。
.BR utmp (5)
を参照すること。
.LP
.\"O The function
.\"O .BR login ()
.\"O takes the supplied \fIstruct utmp\fP
.\"O .IR ut ,
.\"O and writes it to both the utmp and the wtmp file.
関数
.BR login ()
は与えられた \fIstruct utmp\fP
.I ut
を utmp と wtmp ファイルの両方に書き込む。
.LP
.\"O The function
.\"O .BR logout ()
.\"O clears the entry in the utmp file again.
関数
.BR logout ()
は utmp ファイルにあるエントリをクリアする。
.\"O .SS "GNU Details"
.SS "GNU 版の詳細"
.\"O More precisely,
.\"O .BR login ()
.\"O takes the argument
.\"O .I ut
.\"O struct, fills the field
.\"O .I ut\->ut_type
.\"O (if there is such a field) with the value
.\"O .BR USER_PROCESS ,
.\"O and fills the field
.\"O .I ut\->ut_pid
.\"O (if there is such a field) with the process ID of the calling process.
より正確には、
.BR login ()
は引き数
.I ut
構造体をとり、(もし存在するならば) フィールド
.I ut\->ut_type
を
.B USER_PROCESS
という値にし、(もし存在するならば) フィールド
.I ut\->ut_pid
を呼び出し元プロセスのプロセス ID の値にする。
.\"O Then it tries to fill the field
.\"O .IR ut\->ut_line .
次にフィールド
.I ut\->ut_line
の値を設定しようとする。
.\"O It takes the first of \fIstdin\fP, \fIstdout\fP, \fIstderr\fP
.\"O that is a tty, and
.\"O stores the corresponding pathname minus a possible leading \fI/dev/\fP
.\"O into this field, and then writes the struct to the utmp file.
この関数は、標準入力・標準出力・標準エラー出力の中から
端末 (tty) である最初のものをとり、
対応するパス名から先頭の \fI/dev/\fP を引いたものを
このフィールドに格納して、この構造体を utmp ファイルに書き込む。
.\"O On the other hand, if no tty name was found, this field is filled with "???"
.\"O and the struct is not written to the utmp file.
.\"O After this, the struct is written to the wtmp file.
一方、端末名が見つからない場合は、このフィールドは "???" とされて、
この構造体は utmp ファイルに書き込まれない。
その後にこの構造体は wtmp ファイルに書き込まれる。
.LP
.\"O The
.\"O .BR logout ()
.\"O function searches the utmp file for an entry matching the
.\"O .I ut_line
.\"O argument.
.\"O If a record is found, it is updated by zeroing out the
.\"O .I ut_name
.\"O and
.\"O .I ut_host
.\"O fields, updating the
.\"O .I ut_tv
.\"O timestamp field and setting
.\"O .I ut_type
.\"O (if there is such a field) to
.\"O .BR DEAD_PROCESS .
.BR logout ()
関数は utmp ファイルから
.I ut_line
引き数にマッチするエントリを探す。
レコードが見つかった場合、
.I ut_name
と
.I ut_host
フィールドをクリアして、
.I ut_tv
タイムスタンプフィールドを更新し、
(もし存在するならば)
.I ut_type
フィールドを
.B DEAD_PROCESS
に更新する。
.\"O .SH "RETURN VALUE"
.SH 返り値
.\"O The
.\"O .BR logout ()
.\"O function returns 1 if the entry was successfully written to the
.\"O database, or 0 if an error occurred.
エントリをデータベースに書き込むのに成功した場合、
.BR logout ()
関数は 1 を返す。
またエラーが起こった場合、0 を返す。
.\"O .SH FILES
.SH ファイル
.TP
.I /var/run/utmp
.\"O user accounting database, configured through
.\"O .B _PATH_UTMP
.\"O in
.\"O .I <paths.h>
ユーザアカウントデータベース。
.I <paths.h>
における
.B _PATH_UTMP
で設定されている。
.TP
.I /var/log/wtmp
.\"O user accounting log file, configured through
.\"O .B _PATH_WTMP
.\"O in
.\"O .I <paths.h>
ユーザアカウントログファイル。
.I <paths.h>
における
.B _PATH_WTMP
で設定されている。
.\"O .SH "CONFORMING TO"
.SH 準拠
.\"O Not in POSIX.1-2001.
.\"O Present on the BSDs.
POSIX.1-2001 にはない。
BSD 系に存在する。
.\"O .SH NOTES
.SH 注意
.\"O Note that the
.\"O member
.\"O .I ut_user
.\"O of
.\"O .I struct utmp
.\"O is called
.\"O .I ut_name
.\"O in BSD.
.\"O Therefore,
.\"O .I ut_name
.\"O is defined as an alias for
.\"O .I ut_user
.\"O in
.\"O .IR <utmp.h> .
.I struct utmp
のメンバ
.I ut_user
は、BSD では
.I ut_name
という名前である点に注意すること。
そのため
.I ut_name
は
.I <utmp.h>
において
.I ut_user
のエイリアスとして定義されている。
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR getutent (3),
.BR utmp (5)
