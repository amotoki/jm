.\" Copyright (c) Bruno Haible <haible@clisp.cons.org>
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" References consulted:
.\"   GNU glibc-2 source code and manual
.\"   Dinkumware C library reference http://www.dinkumware.com/
.\"   OpenGroup's Single UNIX specification http://www.UNIX-systems.org/online.html
.\"   ISO/IEC 9899:1999
.\"
.\" About this Japanese page, please contact to JM Project <JM@linux.or.jp>
.\" Translated Mon Oct 25 22:55:40 JST 1999
.\"           by FUJIWARA Teruyoshi <fujiwara@linux.or.jp>
.\"
.TH WCRTOMB 3  2011-09-28 "GNU" "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O wcrtomb \- convert a wide character to a multibyte sequence
wcrtomb \- ワイド文字 1 つをマルチバイト列に変換する
.\"O .SH SYNOPSIS
.SH 書式
.nf
.B #include <wchar.h>
.sp
.BI "size_t wcrtomb(char *" s ", wchar_t " wc ", mbstate_t *" ps );
.fi
.\"O .SH DESCRIPTION
.SH 説明
.\"O The main case for this function is when \fIs\fP is
.\"O not NULL and \fIwc\fP is not a null wide character (L\(aq\\0\(aq).
この関数が主に使われるのは、\fIs\fP が NULL でなく、
\fIwc\fP が NULL ワイド文字 (L\(aq\\0\(aq) でない場合である。
.\"O In this case, the
.\"O .BR wcrtomb ()
.\"O function
.\"O converts the wide character \fIwc\fP
.\"O to its multibyte representation and stores it
.\"O at the beginning of the character
.\"O array pointed to by \fIs\fP.
.\"O It updates the shift state \fI*ps\fP, and
.\"O returns the length of said multibyte representation,
.\"O that is, the number of bytes
.\"O written at \fIs\fP.
この場合には、
.BR wcrtomb ()
関数はワイド文字 \fIwc\fP をマルチバイト表
現に変換し、\fIs\fP が指す char 型の配列にこれを格納する。この関数は
シフト状態 \fI*ps\fP を更新し、出力されたマルチバイト表現の長さ、すな
わち \fIs\fP に書き込まれたバイト数を返す。
.PP
.\"O A different case is when \fIs\fP is not NULL,
.\"O but \fIwc\fP is a null wide character (L\(aq\\0\(aq).
.\"O In this
.\"O case the
.\"O .BR wcrtomb ()
.\"O function stores at
.\"O the character array pointed to by
.\"O \fIs\fP the shift sequence needed to
.\"O bring \fI*ps\fP back to the initial state,
.\"O followed by a \(aq\\0\(aq byte.
.\"O It updates the shift state \fI*ps\fP (i.e., brings
.\"O it into the initial state),
.\"O and returns the length of the shift sequence plus
.\"O one, that is, the number of bytes written at \fIs\fP.
別のケースとしては、\fIs\fP は NULL でないが
\fIwc\fP が NULL ワイド文字 (L\(aq\\0\(aq) のことがある。
この場合の
.BR wcrtomb ()
関数は、\fI*ps\fP を初期状態に戻すのに必
要なシフトシーケンスを \fIs\fP が指す char 型配列に格納し、その後に \(aq\\0\(aq
を格納する。この関数はシフト状態 \fI*ps\fP を更新し(つまり初期状態に戻
し)、シフトシーケンスの長さに 1 を加えた値を返す。この値は \fIs\fP に
書き込まれたバイト数である。
.PP
.\"O A third case is when \fIs\fP is NULL.
.\"O In this case \fIwc\fP is ignored,
.\"O and the function effectively returns
.\"O 
.\"O     wcrtomb(buf, L\(aq\\0\(aq, ps)
.\"O 
.\"O where
.\"O .I buf
.\"O is an internal anonymous buffer.
三番目のケースは、\fIs\fP が NULL の時である。
この場合には \fIwc\fP は無視され、関数の実際の動きとしては

    wcrtomb(buf, L\(aq\\0\(aq, ps)

が返される。ここで、
.I buf
は内部的な無名バッファである。

.PP
.\"O In all of the above cases, if \fIps\fP is a NULL pointer, a static anonymous
.\"O state only known to the
.\"O .BR wcrtomb ()
.\"O function is used instead.
以上のいずれの場合も、\fIps\fP が NULL ポインタならばシフト状態は用い
られず、
.BR wcrtomb ()
関数だけが知っている静的な匿名の状態が使われる。
.\"O .SH "RETURN VALUE"
.SH 返り値
.\"O The
.\"O .BR wcrtomb ()
.\"O function returns the number of
.\"O bytes that have been or would
.\"O have been written to the byte array at \fIs\fP.
.\"O If \fIwc\fP can not be
.\"O represented as a multibyte sequence (according to the current locale),
.\"O .I (size_t)\ \-1
.\"O is returned, and \fIerrno\fP set to \fBEILSEQ\fP.
.BR wcrtomb ()
関数は、\fIs\fP が指すバイト列に書き込まれたバイト数、あ
るいは書き込まれたであろうバイト数を返す。\fIwc\fP を(現在のロケールに
従って)マルチバイト列で表現できなければ、
.I (size_t)\ \-1
が返され、 \fIerrno\fP に \fBEILSEQ\fP が設定される。
.\"O .SH "CONFORMING TO"
.SH 準拠
C99.
.\"O .SH NOTES
.SH 注意
.\"O The behavior of
.\"O .BR wcrtomb ()
.\"O depends on the
.\"O .B LC_CTYPE
.\"O category of the
.\"O current locale.
.BR wcrtomb ()
の動作は、現在のロケールの
.B LC_CTYPE
カテゴリに依存する。
.PP
.\"O Passing NULL as \fIps\fP is not multithread safe.
\fIps\fP に NULL を渡した際の動作はマルチスレッドセーフでない。
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR wcsrtombs (3)
