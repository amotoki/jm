.\" Copyright 1993 Mitchum DSouza <m.dsouza@mrc-apu.cam.ac.uk>
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one.
.\"
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\"
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" Modified, jmv@lucifer.dorms.spbu.ru, 1999-11-08
.\" Modified, aeb, 2000-04-07
.\" Updated from glibc docs, C. Scott Ananian, 2001-08-25
.\" Modified, aeb, 2001-08-31
.\" Modified, wharms 2001-11-12, remark on white space and example
.\"
.\" Japanese Version Copyright (c) 1998 SHOJI Yasushi all rights reserved.
.\" Translated Fri Jun 26 1998 by SHOJI Yasushi <yashi@yashi.com>
.\" Updated & Modefied Sun Mar 7 1999 by Shouichi Saito
.\" Updated Tue Oct 10 22:29:13 JST 2000
.\" 	by Yuichi SATO <sato@complex.eng.hokudai.ac.jp>
.\" Updated Tue Apr  3 20:49:00 JST 2001
.\"     by Yuichi SATO <ysato@h4.dion.ne.jp>
.\" Updated Thu Oct 11 10:05:36 JST 2001 by Yuichi SATO
.\" Updated Fri Dec 14 16:34:23 JST 2001 by Yuichi SATO
.\" Updated Sat Jan  5 22:17:34 JST 2002 by Yuichi SATO
.\" Updated Wed Jan 14 23:21:57 JST 2002 by Akihiro MOTOKI <amotoki@dd.iij4u.or.jp>
.\"
.\"WORD:	modifier	修正子
.\"WORD:	broken-down time	要素別の時刻
.\"
.TH STRPTIME 3 2009-12-05 "GNU" "Linux Programmer's Manual"
.\"O .SH NAME
.SH 名前
.\"O strptime \- convert a string representation of time to a time tm structure
strptime \- 文字列であらわされている時間を tm 構造体の時間に変換する
.\"O .SH SYNOPSIS
.SH 書式
.\"O .BR "#define _XOPEN_SOURCE" "       /* See feature_test_macros(7) */"
.BR "#define _XOPEN_SOURCE" "       /* feature_test_macros(7) 参照 */"
.br
.B #include <time.h>
.sp
.BI "char *strptime(const char *" s ", const char *" format ,
.BI "struct tm *" tm );
.\"O .SH DESCRIPTION
.SH 説明
.\"O The
.\"O .BR strptime ()
.\"O function is the converse function to
.\"O .BR strftime (3)
.\"O and converts the character string pointed to by
.\"O .I s
.\"O to values which are stored in the
.\"O .I tm
.\"O structure pointed to by
.\"O .IR tm ,
.\"O using the format specified by
.\"O .IR format .
.BR strptime ()
関数は
.BR strftime (3)
の逆関数であり、ポインタ
.I s
が指す文字列を時間に変換する。
変換の際には
.I format
で指定したフォーマットを用い、値はポインタ
.I tm
が指す
.I tm
構造体に収められる。
.\"O Here
.\"O .I format
.\"O is a character string that consists of field descriptors and text characters,
.\"O reminiscent of
.\"O .BR scanf (3).
.\"O Each field descriptor consists of a
.\"O .B %
.\"O character followed by another character that specifies the replacement
.\"O for the field descriptor.
.I format
は、
.BR scanf (3)
で使われているような、
フィールドディスクリプターとテキスト文字で構成されている文字列である。
個々のフィールドディスクリプターは
.B %
とそれに続く文字からなり、
後者にフィールドディスクリプターを置き換える内容を指定する。
.\"O All other characters in the
.\"O .I format
.\"O string must have a matching character in the input string,
.\"O except for whitespace, which matches zero or more
.\"O whitespace characters in the input string.
.\"O There should be white\%space or other alphanumeric characters
.\"O between any two field descriptors.
.I format
文字列中の他の全ての文字には、入力文字列にマッチする文字がなければならない。
フォーマット文字列中にある空白は例外であり、
入力文字列中の 0 個以上の空白とマッチする。
2 つのフィールドディスクリプターの間には、
空白・英字・数字がなければならない。
.PP
.\"O The
.\"O .BR strptime ()
.\"O function processes the input string from left
.\"O to right.
.\"O Each of the three possible input elements (whitespace,
.\"O literal, or format) are handled one after the other.
.\"O If the input cannot be matched to the format string the function stops.
.\"O The remainder of the format and input strings are not processed.
.BR strptime ()
関数は、入力文字列を左から右へ処理する。
入力された 3 つの要素 (空白・文字・フォーマット) は、順に処理される。
入力がフォーマット文字列とマッチできない場合、関数は停止する。
残りのフォーマット文字列と入力文字列は処理されない。
.PP
.\"O The supported input field descriptors are listed below.
.\"O In case a text string (such as a weekday or month name)
.\"O is to be matched, the comparison is case insensitive.
.\"O In case a number is to be matched, leading zeros are
.\"O permitted but not required.
使用可能なフィールドディスクリプターを以下に挙げる。
(曜日や月の名前といった) 文字列をマッチさせる場合、
大文字と小文字は区別せずに比較する。
数をマッチさせる場合、前に 0 をつけても構わないが必ずしも必要ではない。
.TP
.B %%
.\"O The
.\"O .B %
.\"O character.
文字としての
.BR % 。
.TP
.\"O .BR %a " or " %A
.BR %a " または " %A
.\"O The weekday name according to the current locale,
.\"O in abbreviated form or the full name.
現在のロケールでの曜日名 (省略名または完全な名前)。
.TP
.\"O .BR %b " or " %B " or " %h
.BR %b " または " %B " または " %h
.\"O The month name according to the current locale,
.\"O in abbreviated form or the full name.
現在のロケールでの月名 (省略名または完全な名前)。
.TP
.B %c
.\"O The date and time representation for the current locale.
現在のロケールでの日付と時刻の表現。
.TP
.B %C
.\"O The century number (0-99).
1 世紀中の年 (0-99)。
.TP
.\"O .BR %d " or " %e
.BR %d " または " %e
.\"O The day of month (1-31).
月内の日付 (1-31)。
.TP
.B %D
.\"O Equivalent to
.\"O .BR %m/%d/%y .
.\"O (This is the American style date, very confusing
.\"O to non-Americans, especially since
.\"O .B %d/%m/%y
.\"O is widely used in Europe.
.\"O The ISO 8601 standard format is
.\"O .BR %Y-%m-%d .)
日付。
.B %m/%d/%y
と同じ。
(これはアメリカ式の日付形式で、
ヨーロッパでは特に
.B %d/%m/%y
という形式が広く使われているために、
アメリカ人以外には紛らわしく感じられる。
ISO 8601 規格では
.B %Y-%m-%d
という形式である。)
.TP
.B %H
.\"O The hour (0-23).
時間 (0-23)。
.TP
.B %I
.\"O The hour on a 12-hour clock (1-12).
12 時間制での時間 (1-12)。
.TP
.B %j
.\"O The day number in the year (1-366).
年の初めからの通算の日付 (1-366)。
.TP
.B %m
.\"O The month number (1-12).
数字表現の月 (1-12)。
.TP
.B %M
.\"O The minute (0-59).
分 (0-59)。
.TP
.B %n
.\"O Arbitrary whitespace.
任意の空白。
.TP
.B %p
.\"O The locale's equivalent of AM or PM.
.\"O (Note: there may be none.)
ロケールの AM (午前) と PM (午後) に対応するもの。
(注意: 対応するものがないかもしれない。)
.TP
.B %r
.\"O The 12-hour clock time (using the locale's AM or PM).
.\"O In the POSIX locale equivalent to
.\"O .BR "%I:%M:%S %p" .
.\"O If \fIt_fmt_ampm\fP is empty in the
.\"O .B LC_TIME
.\"O part of the current locale
.\"O then the behavior is undefined.
(ロケールの AM と PM を使った) 12 時間制の時間。
POSIX ロケールでは
.B %I:%M:%S %p
と同じ。
現在のロケールにおいて
.B LC_TIME
パートの
\fIt_fmt_ampm\fP が定義されていない場合、
動作は未定義である。
.TP
.B %R
.\"O Equivalent to
.\"O .BR %H:%M .
.B %H:%M
と同じ。
.TP
.B %S
.\"O The second (0-60; 60 may occur for leap seconds;
.\"O earlier also 61 was allowed).
秒 (0-60; 60 は閏秒を示す。以前は 61 も指定できた)。
.TP
.B %t
.\"O Arbitrary whitespace.
任意の空白。
.TP
.B %T
.\"O Equivalent to
.\"O .BR %H:%M:%S .
.B %H:%M:%S
と同じ。
.TP
.B %U
.\"O The week number with Sunday the first day of the week (0-53).
.\"O The first Sunday of January is the first day of week 1.
日曜日を週の始まりとした年通算での週数 (0-53)。
1 月の最初の日曜日を第 1 週目の最初の日する。
.TP
.B %w
.\"O The weekday number (0-6) with Sunday = 0.
日曜日を 0 とした数字表記の曜日 (0-6)。
.TP
.B %W
.\"O The week number with Monday the first day of the week (0-53).
.\"O The first Monday of January is the first day of week 1.
月曜日を週の始まりとした年通算での週数 (0-53)。
1 月の最初の月曜日を第 1 週目の最初の日する。
.TP
.B %x
.\"O The date, using the locale's date format.
日付。ロケールの日付フォーマットを使う。
.TP
.B %X
.\"O The time, using the locale's time format.
時刻。ロケールの時刻フォーマットを使う。
.TP
.B %y
.\"O The year within century (0-99).
.\"O When a century is not otherwise specified, values in the range 69-99 refer
.\"O to years in the twentieth century (1969-1999); values in the
.\"O range 00-68 refer to years in the twenty-first century (2000-2068).
1 世紀中の年 (0-99)。
世紀が指定されない場合、
値が 69-99 の範囲のときは 20 世紀の年 (1969-1999)、
値が 00-68 の範囲のときは 21 世紀の年 (2000-2068) とする。
.TP
.B %Y
.\"O The year, including century (for example, 1991).
年。世紀の部分を含む (例: 1991)。
.LP
.\"O Some field descriptors can be modified by the E or O modifier characters
.\"O to indicate that an alternative format or specification should be used.
.\"O If the
.\"O alternative format or specification does not exist in the current locale, the
.\"O unmodified field descriptor is used.
E や O という修正子を使うことで変更できるフィールドディスクリプタもある。
これらの修正子は、別のフォーマットや仕様を使うことを指示する。
別のフォーマットや仕様が現在のロケールに存在しないときは、
変更していないフィールドディスクリプタが使われる。
.LP
.\"O The E modifier specifies that the input string may contain
.\"O alternative locale-dependent versions of the date and time representation:
E 修正子は、ロケールに依存した日付と時刻の別の表現形式が
入力文字列に含まれていることを指定する。
.TP
.B %Ec
.\"O The locale's alternative date and time representation.
日付と時刻。ロケールに依存した別の表現形式を使う。
.TP
.B %EC
.\"O The name of the base year (period) in the locale's alternative representation.
基準年 (期間) の名前。ロケールに依存した別の表現形式を使う。
.TP
.B %Ex
.\"O The locale's alternative date representation.
日付。ロケールに依存した別の表現形式を使う。
.TP
.B %EX
.\"O The locale's alternative time representation.
時刻。ロケールに依存した別の表現形式を使う。
.TP
.B %Ey
.\"O The offset from
.\"O .B %EC
.\"O (year only) in the locale's alternative representation.
.B %EC
(年のみ) からのオフセット。ロケールに依存した別の表現形式を使う。
.TP
.B %EY
.\"O The full alternative year representation.
完全な形式の年。別の表現型式を使う。
.LP
.\"O The O modifier specifies that the numerical input may be in an
.\"O alternative locale-dependent format:
O 修正子は、ロケールに依存した別のフォーマットの中に
数値の入力があることを指定する。
.TP
.\"O .BR %Od " or " %Oe
.BR %Od " または " %Oe
.\"O The day of the month using the locale's alternative numeric symbols;
.\"O leading zeros are permitted but not required.
月の初めからの通算の日付。ロケールに依存した別の数値シンボルを使う。
0 を頭につけてもよいが、必須ではない。
.TP
.B %OH
.\"O The hour (24-hour clock) using the locale's alternative numeric symbols.
時間 (24 時間制)。ロケールに依存した別の数値シンボルを使う。
.TP
.B %OI
.\"O The hour (12-hour clock) using the locale's alternative numeric symbols.
時間 (12 時間制)。ロケールに依存した別の数値シンボルを使う。
.TP
.B %Om
.\"O The month using the locale's alternative numeric symbols.
月。ロケールに依存した別の数値シンボルを使う。
.TP
.B %OM
.\"O The minutes using the locale's alternative numeric symbols.
分。ロケールに依存した別の数値シンボルを使う。
.TP
.B %OS
.\"O The seconds using the locale's alternative numeric symbols.
秒。ロケールに依存した別の数値シンボルを使う。
.TP
.B %OU
.\"O The week number of the year (Sunday as the first day of the week)
.\"O using the locale's alternative numeric symbols.
年の初めからの通算の週数 (日曜日を週の始めとする)。
ロケールに依存した別の数値シンボルを使う。
.TP
.B %Ow
.\"O The number of the weekday (Sunday=0) using the locale's alternative
.\"O numeric symbols.
数値表記の曜日 (日曜日を 0 とする)。
ロケールに依存した別の数値シンボルを使う。
.TP
.B %OW
.\"O The week number of the year (Monday as the first day of the week)
.\"O using the locale's alternative numeric symbols.
年の初めからの通算の週数 (月曜日を週の始めとする)。
ロケールに依存した別の数値シンボルを使う。
.TP
.B %Oy
.\"O The year (offset from %C) using the locale's alternative numeric symbols.
.\"O The year (offset from
.\"O .BR %C )
.\"O using the locale's alternative numeric symbols.
年
.RB ( %C
からのオフセット)。ロケールに依存した別の数値シンボルを使う。
.LP
.\"O The broken-down time structure \fItm\fP is defined in \fI<time.h>\fP
.\"O as follows:
要素別の時刻構造体 \fItm\fP は
\fI<time.h>\fP 内で以下の様に定義されている。
.sp
.in +4n
.nf
.\"O struct tm {
.\"O     int tm_sec;        /* seconds */
.\"O     int tm_min;        /* minutes */
.\"O     int tm_hour;       /* hours */
.\"O     int tm_mday;       /* day of the month */
.\"O     int tm_mon;        /* month */
.\"O     int tm_year;       /* year */
.\"O     int tm_wday;       /* day of the week */
.\"O     int tm_yday;       /* day in the year */
.\"O     int tm_isdst;      /* daylight saving time */
.\"O };
struct tm {
    int tm_sec;        /* 秒 */
    int tm_min;        /* 分 */
    int tm_hour;       /* 時間 */
    int tm_mday;       /* 日 */
    int tm_mon;        /* 月 */
    int tm_year;       /* 年 */
    int tm_wday;       /* 曜日 */
    int tm_yday;       /* 年内通算日 */
    int tm_isdst;      /* 夏時間 */
};
.fi
.in
.\"O .SH "RETURN VALUE"
.SH 返り値
.\"O The return value of the function is a pointer to the first character
.\"O not processed in this function call.
.\"O In case the input string
.\"O contains more characters than required by the format string the return
.\"O value points right after the last consumed input character.
.\"O In case
.\"O the whole input string is consumed the return value points to the null
.\"O byte at the end of the string.
.\"O If
.\"O .BR strptime ()
.\"O fails to match all
.\"O of the format string and therefore an error occurred the function
.\"O returns NULL.
この関数の返り値は、関数の中で処理されなかった最初の文字へのポインタである。
フォーマット文字列が必要する以上の文字が入力文字列に含まれている場合、
返り値は最後に処理された入力文字の次の文字を指す。
すべての入力文字列が処理された場合、
返り値は文字列末尾の NULL バイトを指す。
.BR strptime ()
がフォーマット文字列のすべての比較に失敗し、
エラーが起こった場合、関数は NULL ポインタを返す。
.\"O .SH "CONFORMING TO"
.SH 準拠
SUSv2, POSIX.1-2001.
.\"O .SH NOTES
.SH 注意
.LP
.\"O In principle, this function does not initialize \fItm\fP but
.\"O only stores the values specified.
.\"O This means that \fItm\fP should be initialized before the call.
.\"O Details differ a bit between different UNIX systems.
.\"O The glibc implementation does not touch those fields which are not
.\"O explicitly specified, except that it recomputes the
.\"O .I tm_wday
.\"O and
.\"O .I tm_yday
.\"O field if any of the year, month, or day elements changed.
原則として、この関数は \fItm\fP の初期化はせずに、
指定された値のみを入れる。
つまり、この関数の呼び出しの前に \fItm\fP を初期化しなければならない。
他の UNIX システムとは、細かい点で異なる。
glibc の実装では、明示的に指定されないフィールドは変更されない。
例外として、年・月・日のいずれかの要素が変更された場合に
.I tm_wday
と
.I tm_yday
が再計算される。
.PP
.\"O This function is available since libc 4.6.8.
.\"O Linux libc4 and libc5 includes define the prototype unconditionally;
.\"O glibc2 includes provide a prototype only when
.\"O .B _XOPEN_SOURCE
.\"O or
.\"O .B _GNU_SOURCE
.\"O are defined.
この関数は、libc 4.6.8 以降で使用できる。
Linux の libc4 と libc5 のインクルードファイルは、
この関数のプロトタイプを常に定義する。
glibc2 のインクルードファイルは、
.B _XOPEN_SOURCE
または
.B _GNU_SOURCE
が定義された場合のみ、
この関数のプロトタイプを提供する。
.PP
.\"O Before libc 5.4.13 whitespace
.\"O (and the \(aqn\(aq and \(aqt\(aq specifications) was not handled,
.\"O no \(aqE\(aq and \(aqO\(aq locale modifier characters were accepted,
.\"O and the \(aqC\(aq specification was a synonym for the \(aqc\(aq specification.
libc 5.4.13 より前では、空白 (と \(aqn\(aq または \(aqt\(aq 指定) は扱われなかった。
ロケールの修正子 \(aqE\(aq と \(aqO\(aq は受け付けられなかった。
また、\(aqC\(aq の指定は \(aqc\(aq の指定と同じ意味で扱われた。
.PP
.\"O The \(aqy\(aq (year in century) specification is taken to specify a year
.\"O in the 20th century by libc4 and libc5.
.\"O It is taken to be a year
.\"O in the range 1950-2049 by glibc 2.0.
.\"O It is taken to be a year in
.\"O 1969-2068 since glibc 2.1.
\(aqy\(aq (1 世紀中の年) の指定は、libc4 と libc5 では 20 世紀の年として解釈される。
glibc 2.0 では 1950-2049 の範囲として解釈される。
glibc 2.1 からは 1969-2068 の範囲として解釈される。
.\"O .\" In libc4 and libc5 the code for %I is broken (fixed in glibc;
.\"O .\" %OI was fixed in glibc 2.2.4).
.\" libc4 と libc5 では %I 用のコードが壊れている (glibc で修正された;
.\" %OI は glibc 2.2.4 で修正された)。
.\"O .SS Glibc Notes
.SS glibc での注意
.\"O For reasons of symmetry, glibc tries to support for
.\"O .BR strptime ()
.\"O the same format characters as for
.\"O .BR strftime (3).
対象性のために、glibc では
.BR strptime ()
に
.BR strftime (3)
と同じフォーマット文字をサポートさせようとしている。
.\"O In most cases the corresponding fields are parsed, but no field in \fItm\fP
.\"O is changed.)
.\"O This leads to
多くの場合、対応するフィールドが解釈されるが、
\fItm\fP フィールドは変更されない。
使用可能なフォーマット文字を以下に示す。
.TP
.B %F
.\"O Equivalent to \fB%Y-%m-%d\fP, the ISO 8601 date format.
\fB%Y-%m-%d\fP と同じ。ISO 8601 の日付形式。
.TP
.B %g
.\"O The year corresponding to the ISO week number, but without the century
.\"O (0-99).
ISO 週数に対応した西暦年。世紀は含まず (0-99) の範囲。
.TP
.B %G
.\"O The year corresponding to the ISO week number.
.\"O (For example, 1991.)
ISO 週数に対応した西暦年 (例えば 1991)。
.TP
.B %u
.\"O The day of the week as a decimal number (1-7, where Monday = 1).
10 進数表記の曜日 (1-7 で月曜日を 1 とする)。
.TP
.B %V
.\"O The ISO 8601:1988 week number as a decimal number (1-53).
.\"O If the week (starting on Monday) containing 1 January has four or more days
.\"O in the new year, then it is considered week 1.
.\"O Otherwise, it is the last week
.\"O of the previous year, and the next week is week 1.
ISO 8601:1988 形式での年通算の 10 進数表記での週数 (1-53)。
1 月 1 日を含む (月曜日から始まる) 週に 4 日以上が含まれている場合は、
その週を第 1 週とする。
3 日以下しか含まれていない場合は、1 月 1 日を含む週を前年の最終の週として、
次の週を第 1 週とする。
.TP
.B %z
.\"O An RFC-822/ISO 8601 standard timezone specification.
RFC-822/ISO 8601 標準タイムゾーンを指定する。
.TP
.B %Z
.\"O The timezone name.
タイムゾーン名。
.LP
.\"O Similarly, because of GNU extensions to
.\"O .BR strftime (3),
.\"O .B %k
.\"O is accepted as a synonym for
.\"O .BR %H ,
.\"O and
.\"O .B %l
.\"O should be accepted
.\"O as a synonym for
.\"O .BR %I ,
.\"O and
.\"O .B %P
.\"O is accepted as a synonym for
.\"O .BR %p .
同様に、
.BR strftime (3)
の GNU 版での拡張に対応するために、
.B %k
は
.B %H、
.B %P
は
.B %p
と等価に扱われる。また、
.B %l
は
.B %I
と等価に扱われるようになるはずである。

.\"O Finally
さらに以下も定義されている。
.TP
.B %s
.\"O The number of seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).
.\"O Leap seconds are not counted unless leap second support is available.
紀元 (Epoch; 1970-01-01 00:00:00 +0000 (UTC)) からの通算の秒数。
閏秒がサポートされていない限り、閏秒はカウントしない。
.LP
.\"O The glibc implementation does not require whitespace between
.\"O two field descriptors.
glibc における実装では、2 つのフィールド間の空白は必要ない。
.\"O .SH EXAMPLE
.SH 例
.\"O The following example demonstrates the use of
.\"O .BR strptime ()
.\"O and
.\"O .BR strftime (3).
以下の例は
.BR strptime ()
と
.BR strftime (3)
の使用法を示している。
.sp
.nf
#define _XOPEN_SOURCE
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

int
main(void)
{
    struct tm tm;
    char buf[255];

    memset(&tm, 0, sizeof(struct tm));
    strptime("2001\-11\-12 18:31:01", "%Y\-%m\-%d %H:%M:%S", &tm);
    strftime(buf, sizeof(buf), "%d %b %Y %H:%M", &tm);
    puts(buf);
    exit(EXIT_SUCCESS);
}
.fi
.\"O .SH "SEE ALSO"
.SH 関連項目
.BR time (2),
.BR getdate (3),
.BR scanf (3),
.BR setlocale (3),
.BR strftime (3)
