.\" From Henry Spencer's regex package (as found in the apache
.\" distribution). The package carries the following copyright:
.\"
.\"  Copyright 1992, 1993, 1994 Henry Spencer.  All rights reserved.
.\"  This software is not subject to any license of the American Telephone
.\"  and Telegraph Company or of the Regents of the University of California.
.\"
.\"  Permission is granted to anyone to use this software for any purpose
.\"  on any computer system, and to alter it and redistribute it, subject
.\"  to the following restrictions:
.\"
.\"  1. The author is not responsible for the consequences of use of this
.\"     software, no matter how awful, even if they arise from flaws in it.
.\"
.\"  2. The origin of this software must not be misrepresented, either by
.\"     explicit claim or by omission.  Since few users ever read sources,
.\"     credits must appear in the documentation.
.\"
.\"  3. Altered versions must be plainly marked as such, and must not be
.\"     misrepresented as being the original software.  Since few users
.\"     ever read sources, credits must appear in the documentation.
.\"
.\"  4. This notice may not be removed or altered.
.\"
.\" In order to comply with `credits must appear in the documentation'
.\" I added an AUTHOR paragraph below - aeb.
.\"
.\" In the default nroff environment there is no dagger \(dg.
.\"
.\" 2005-05-11 Removed discussion of `[[:<:]]' and `[[:>:]]', which
.\" 	appear not to be in the glibc implementation of regcomp
.\"
.ie t .ds dg \(dg
.el .ds dg (!)
.\"
.\" Japanese Version Copyright (c) 1998 NAKANO Takeo all rights reserved.
.\" Translated Wed 8 Jul 1998 by NAKANO Takeo <nakano@apm.seikei.ac.jp>
.\"
.\"WORD:	regular expression	正規表現
.\"WORD:	modern RE		新しい正規表現
.\"WORD:	obsolete RE		古い正規表現
.\"WORD:	basic RE		基本正規表現
.\"WORD:	extended RE		拡張正規表現
.\"WORD:	branch			枝
.\"WORD:	piece			文節
.\"WORD:	atom			アトム
.\"WORD:	bound			繰り返し指定
.\"WORD:	bracket expression	ブラケット表現
.\"WORD:	digit			数字
.\"WORD:	collating sequence	照合順序
.\"WORD:	collating element	照合順序の要素
.\"WORD:	character class		文字クラス
.\"WORD:	equivalent class	等価クラス
.\"WORD:	substring		部分文字列
.\"WORD:	subexpression		部分正規表現
.\"
.TH REGEX 7 2009-01-12 "" "Linux Programmer's Manual"
.\"O .SH NAME
.\"O regex \- POSIX.2 regular expressions
.SH 名前
regex \- POSIX.2 正規表現
.\"O .SH DESCRIPTION
.SH 説明
.\"O Regular expressions ("RE"s),
.\"O as defined in POSIX.2, come in two forms:
.\"O modern REs (roughly those of
.\"O .IR egrep ;
.\"O POSIX.2 calls these "extended" REs)
.\"O and obsolete REs (roughly those of
.\"O .BR ed ;
.\"O POSIX.2 "basic" REs).
.\"O Obsolete REs mostly exist for backward compatibility in some old programs;
.\"O they will be discussed at the end.
.\"O POSIX.2 leaves some aspects of RE syntax and semantics open;
.\"O "\*(dg" marks decisions on these aspects that
.\"O may not be fully portable to other POSIX.2 implementations.
正規表現 (Regular expression: RE) は POSIX.2 で定義されており、
二つの形式がある。新しい正規表現 (modern RE) と古い正規表現 (obsolete RE)
である。新しい正規表現はだいたい
.I egrep
のものと同じで、 POSIX.2 では「拡張」正規表現 ("extended" RE)
と呼ばれている。古い正規表現はだいたい
.BR ed (1)
のものと同じで、 POSIX.2 では「基本」正規表現 ("basic" RE) である。
古い正規表現は、古いプログラムとの互換性を保つためのものである。
これについては最後に議論する。
POSIX.2 では、正規表現の文法や記号の一部が、未定義のまま残されている。
"\*(dg" は、このような意味で、他の POSIX.2 の実装と
完全には互換でないかも知れない部分である。
.PP
.\"O A (modern) RE is one\*(dg or more nonempty\*(dg \fIbranches\fR,
.\"O separated by \(aq|\(aq.
.\"O It matches anything that matches one of the branches.
(新しい) 正規表現は一つ以上\*(dg の空白でない \fI枝 (branch)\fP からなる。
枝どうしは \(aq|\(aq で区切られる。正規表現は、
枝のどれかにマッチ (match) したものにマッチする。
.PP
.\"O A branch is one\*(dg or more \fIpieces\fR, concatenated.
.\"O It matches a match for the first, followed by a match for the second, etc.
枝は一つ以上の文節 (piece) が結合されたものである。
枝は第一の文節がマッチし、
続いて第二の文節がマッチし、... したものにマッチする。
.PP
.\"O A piece is an \fIatom\fR possibly followed
.\"O by a single\*(dg \(aq*\(aq, \(aq+\(aq, \(aq?\(aq, or \fIbound\fR.
.\"O An atom followed by \(aq*\(aq
.\"O matches a sequence of 0 or more matches of the atom.
.\"O An atom followed by \(aq+\(aq
.\"O matches a sequence of 1 or more matches of the atom.
.\"O An atom followed by \(aq?\(aq
.\"O matches a sequence of 0 or 1 matches of the atom.
文節は\fIアトム (atom)\fR からなる。ただしアトムの後には一つ\*(dg の \(aq*\(aq,
\(aq+\(aq, \(aq?\(aq あるいは \fI繰り返し指定 (bound)\fR が続くこともある。
\(aq*\(aq が後置されたアトムは、マッチしたアトムの 0 個以上の並びにマッチする。
\(aq+\(aq が後置されたアトムは、マッチしたアトムの 1 個以上の並びにマッチする。
\(aq?\(aq が後置されたアトムは、マッチしたアトムの 0 個または 1 個にマッチする。
.PP
.\"O A \fIbound\fR is \(aq{\(aq followed by an unsigned decimal integer,
.\"O possibly followed by \(aq,\(aq
.\"O possibly followed by another unsigned decimal integer,
.\"O always followed by \(aq}\(aq.
\fI繰り返し指定\fRとは \(aq{\(aq に続いて、符号なし 10 進整数、\(aq,\(aq、
もう一つの 10 進整数、\(aq}\(aq を並べたものである。\(aq,\(aq と二つめの
10 進整数は省略できる。二つめの 10 進整数だけを省略することもできる
(最後の `}' は省略できない)。
.\"O The integers must lie between 0 and
.\"O .B RE_DUP_MAX
.\"O (255\*(dg) inclusive,
.\"O and if there are two of them, the first may not exceed the second.
.\"O An atom followed by a bound containing one integer \fIi\fR
.\"O and no comma matches
.\"O a sequence of exactly \fIi\fR matches of the atom.
.\"O An atom followed by a bound
.\"O containing one integer \fIi\fR and a comma matches
.\"O a sequence of \fIi\fR or more matches of the atom.
.\"O An atom followed by a bound
.\"O containing two integers \fIi\fR and \fIj\fR matches
.\"O a sequence of \fIi\fR through \fIj\fR (inclusive) matches of the atom.
整数は 0 以上
.B RE_DUP_MAX
(255\*(dg) 以下の間で指定できる。
二つ指定する場合には、最初の数値は後の数値を越えてはならない。
整数 \fIi\fR だけからなる繰り返し指定を後置されたアトムは、
アトムをぴったりちょうど \fIi\fR 個だけ並べたものにマッチする。
整数 \fIi\fR とコンマが指定された繰り返し指定を後置されたアトムは、
アトムを \fIi\fR個以上並べたものにマッチする。
整数 \fIi\fR と \fIj\fR が指定された繰り返し指定を後置されたアトムは、
アトムを \fIi\fR個以上 \fIj\fR 個以下だけ並べたものにマッチする。
.PP
.\"O An atom is a regular expression enclosed in "\fI()\fP"
.\"O (matching a match for the regular expression),
.\"O an empty set of "\fI()\fP" (matching the null string)\*(dg,
.\"O a \fIbracket expression\fR (see below), \(aq.\(aq
.\"O (matching any single character), \(aq^\(aq (matching the null string at the
.\"O beginning of a line), \(aq$\(aq (matching the null string at the
.\"O end of a line), a \(aq\e\(aq followed by one of the characters
.\"O "\fI^.[$()|*+?{\e\fP"
.\"O (matching that character taken as an ordinary character),
.\"O a \(aq\e\(aq followed by any other character\*(dg
.\"O (matching that character taken as an ordinary character,
.\"O as if the \(aq\e\(aq had not been present\*(dg),
.\"O or a single character with no other significance (matching that character).
アトムの種類は以下の通り。"\fI()\fP" に囲まれた正規表現
(その正規表現がマッチする文字列にマッチする)、
中身が空の "\fI()\fP" (null 文字列にマッチする)\*(dg、
\fIブラケット表現 (bracket expression\fR :後述)、
\(aq.\(aq (任意の 1 文字にマッチする)、
\(aq^\(aq (行頭の空白文字にマッチする)、
\(aq$\(aq (行末の空白文字にマッチする)、
\(aq\e\(aq に "\fI^.[$()|*+?{\e\fP" のいずれか一文字を後置したもの
(通常の文字として扱われ、その文字にマッチする)、
\(aq\e\(aq にそれ以外の文字を後置したもの\*(dg
(\(aq\e\(aq がない場合と同じように、その文字にマッチする\*(dg)、
特に意味を持たない文字一つ (その文字にマッチする)。
.\"O A \(aq{\(aq followed by a character other than a digit is an ordinary
.\"O character, not the beginning of a bound\*(dg.
.\"O It is illegal to end an RE with \(aq\e\(aq.
\(aq{\(aq は数字以外の文字が後置されると通常の文字として扱われ、
繰り返し指定の始まりとはされない\*(dg。\(aq\e\(aq
で終わる正規表現は不正なものとみなされる。
.PP
.\"O A \fIbracket expression\fR is a list of characters enclosed in "\fI[]\fP".
.\"O It normally matches any single character from the list (but see below).
.\"O If the list begins with \(aq^\(aq,
.\"O it matches any single character
.\"O (but see below) \fInot\fR from the rest of the list.
.\"O If two characters in the list are separated by \(aq\-\(aq, this is shorthand
.\"O for the full \fIrange\fR of characters between those two (inclusive) in the
.\"O collating sequence,
.\"O for example, "\fI[0\-9]\fP" in ASCII matches any decimal digit.
.\"O It is illegal\*(dg for two ranges to share an
.\"O endpoint, for example, "\fIa-c-e\fP".
.\"O Ranges are very collating-sequence-dependent,
.\"O and portable programs should avoid relying on them.
\fIブラケット表現\fRは "\fI[]\fP" によって閉じられた文字のリストである。
これは通常リスト中に存在している文字にマッチする。
(例外あり、後述。) リストが \(aq^\(aq で始まると、
\fIブラケット表現\fRはリストに存在して\fIいない\fR文字一つにマッチする
(例外あり、後述)。 リスト中の二つの文字が \(aq\-\(aq で区切られている場合は、
これは照合順序 (collating sequence) でその二つの文字に挟まれる、
すべての文字の並びを短縮したものとみなされる (両端含む)。
例えば "\fI[0\-9]\fP" は ASCII では 10 進の数字 (digit) のいずれかにマッチする。
二つの領域指定が端点を共有してはならない\*(dg。
つまり "\fIa-c-e\fP" のようなものは不正である。領域指定は照合順序に強く依存する。
したがって移植性の高いプログラムを作る場合は、
領域指定には頼らないほうが良いだろう。
.PP
【訳注: 照合順序 (collating sequence) というのは、国際化
(Internationalization) に関連した用語です。アルファベット順に単語を並
べる際には、言語によって並べる基準が異なります。照合順序は、その差異を
吸収するための仕組みです。
.PP
例えば、スペイン語では ch という文字並びを特別扱いするため、アルファベッ
ト順が a, b, c, ch, d, e, ... の順になるそうです。このようなシーケンス
のことを collating sequence と言います。このとき `ch' という文字並びは、
単語整列の際にあたかも「一文字」のように扱われます。ここで、
順序付けを行う際に最小の単位となる、`a'、`b' の文字や
`ch' のような特別な文字並びなど、照合順序の要素のことを
collating element と言います。collating sequence は、文字単位ではなく
collating element を単位として定義されます。】
.PP
.\"O To include a literal \(aq]\(aq in the list, make it the first character
.\"O (following a possible \(aq^\(aq).
.\"O To include a literal \(aq\-\(aq, make it the first or last character,
.\"O or the second endpoint of a range.
.\"O To use a literal `\-' as the first endpoint of a range,
.\"O enclose it in `[.' and `.]' to make it a collating element (see below).
.\"O With the exception of these and some combinations using `[' (see next
.\"O paragraphs), all other special characters, including `\e', lose their
.\"O To use a literal \(aq\-\(aq as the first endpoint of a range,
.\"O enclose it in "\fI[.\fP" and "\fI.]\fP"
.\"O to make it a collating element (see below).
.\"O With the exception of these and some combinations using \(aq[\(aq (see next
.\"O paragraphs), all other special characters, including \(aq\e\(aq, lose their
.\"O special significance within a bracket expression.
文字 \(aq]\(aq そのものをリストに入れたい場合は、
最初の文字として指定すれば良い (\(aq^\(aq) の後に続けるのでも良い)。
文字 \(aq\-\(aq そのものをリストに入れたい場合は、
最初か最後の文字とすれば良い。
あるいは領域指定の終端文字として指定しても良い。
\(aq\-\(aq を領域指定の先頭文字に指定するには、"\fI[.\fP" と "\fI.]\fP" で囲って、
照合順序の要素 (collating element: 後述) にすれば良い。
他の特殊文字 ( も含む) は、
ブラケット表現の内部ではすべて通常の文字として扱われる。
.PP
.\"O Within a bracket expression, a collating element (a character,
.\"O a multicharacter sequence that collates as if it were a single character,
.\"O or a collating-sequence name for either)
.\"O enclosed in "\fI[.\fP" and "\fI.]\fP" stands for the
.\"O sequence of characters of that collating element.
.\"O The sequence is a single element of the bracket expression's list.
.\"O A bracket expression containing a multicharacter collating element
.\"O can thus match more than one character,
.\"O for example, if the collating sequence includes a "ch" collating element,
.\"O then the RE "\fI[[.ch.]]*c\fP" matches the first five characters
.\"O of "chchcc".
ブラケット表現の内部では、"\fI[.\fP" と "\fI.]\fP" に囲われた照合順序の要素は、
その要素に対応する文字並びを表す。
「照合順序の要素」とは、
[1] 文字、 [2] 単一文字のように扱われる複数文字のシーケンス、
[3] 1, 2 いずれかに対応する照合順序上の名前、のいずれかである。
この繰り返しは、ブラケット表現のリストにおける単一の要素となる。
上記 [2] の、「複数文字からなる照合順序要素」を含むブラケット表現は、
したがって一文字以上にマッチすることがある。
例えば、もし照合順序が "ch" という要素を含んでいる場合には、
正規表現 "\fI[[.ch.]]*c\fP" は "chchcc" の最初の 5 文字にマッチする。
.PP
.\"O Within a bracket expression, a collating element enclosed in "\fI[=\fP" and
.\"O "\fI=]\fP" is an equivalence class, standing for the sequences of characters
.\"O of all collating elements equivalent to that one, including itself.
.\"O (If there are no other equivalent collating elements,
.\"O the treatment is as if the enclosing delimiters
.\"O were "\fI[.\fP" and "\fI.]\fP".)
.\"O For example, if o and \o'o^' are the members of an equivalence class,
.\"O then "\fI[[=o=]]\fP", "\fI[[=\o'o^'=]]\fP",
.\"O and "\fI[o\o'o^']\fP" are all synonymous.
.\"O An equivalence class may not\*(dg be an endpoint
.\"O of a range.
ブラケット表現の内部では、"\fI[=\fP" と "\fI=]\fP" に囲まれた照合順序の要素は、
等価クラス (equivalence class) となる。
これは、その要素と等価な要素すべてからなる文字シーケンス (自身も含む) を表す。
他に等価な要素がなければ、
取り扱いは "\fI[.\fP" と "\fI.]\fP" で囲まれている場合と同じである。
例えば o と ou が等価クラスのメンバーであれば、
"\fI[[=o=]]\fP", "\fI[[=\o'o^'=]]\fP", "\fI[o\o'o^']\fP" はすべて同じ意味になる。
等価クラスは領域指定の端点にはなれない\*(dg。
.\" nippon 端末では \o'o^' が正しく出ないので、例示を変更しました。
.PP
.\"O Within a bracket expression, the name of a \fIcharacter class\fR enclosed
.\"O in "\fI[:\fP" and "\fI:]\fP" stands for the list
.\"O of all characters belonging to that
.\"O class.
.\"O Standard character class names are:
ブラケット表現の内部では、"\fI[:\fP" と "\fI:]\fP" で囲われた\fI文字クラス
(character class)\fR はそのクラスに属するすべての文字のリストを表す。
標準で用意されている文字クラスの名前は以下の通り:
.PP
.RS
.nf
.ta 3c 6c 9c
alnum	digit	punct
alpha	graph	space
blank	lower	upper
cntrl	print	xdigit
.fi
.RE
.PP
.\"O These stand for the character classes defined in
.\"O .BR wctype (3).
.\"O A locale may provide others.
.\"O A character class may not be used as an endpoint of a range.
これらは
.BR wctype (3)
で定義されている文字クラスを表している。ロケール (locale) によって、
これら以外のクラスが定義されることもある。
文字クラスは領域指定の端点にはなれない。
.\" .PP
.\"O .\" As per http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=295666
.\"O .\" The following does not seem to apply in the glibc implementation
.\"O .\" There are two special cases\*(dg of bracket expressions:
.\"O .\" the bracket expressions "\fI[[:<:]]\fP" and "\fI[[:>:]]\fP" match
.\"O .\" the null string at the beginning and end of a word respectively.
.\"O .\" A word is defined as a sequence of
.\"O .\" word characters
.\"O .\" which is neither preceded nor followed by
.\"O .\" word characters.
.\"O .\" A word character is an
.\"O .\" .I alnum
.\"O .\" character (as defined by
.\"O .\" .BR wctype (3))
.\"O .\" or an underscore.
.\"O .\" This is an extension,
.\"O .\" compatible with but not specified by POSIX.2,
.\"O .\" and should be used with
.\"O .\" caution in software intended to be portable to other systems.
.\" http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=295666 にあるように
.\" 以下の記載は glibc の実装にはあてはまらないようである。
.\" ブラケット表現には、特殊な意味を持つものが二つ存在する\*(dg。
.\" ブラケット表現 "\fI[[:<:]]\fP" はワード (word) 先頭のヌル文字列に、
.\" "\fI[[:>:]]\fP" はワード末尾のヌル文字列にそれぞれマッチする。
.\" ワードとはワード文字の並びであり、
.\" ワード文字が前置も後置もされていないものである。
.\" ワード文字は
.\" .I alnum
.\" 文字
.\" .RB ( wctype (3)
.\" で定義されている) およびアンダースコア `_' である。
.\" これは拡張記法であり、POSIX.2 に反してはいないが、
.\" 定義もされていない。
.\" 他のシステムと互換性を確保したいソフトウェアでは、
.\" 注意して用いるようにすること。
.PP
.\"O In the event that an RE could match more than one substring of a given
.\"O string,
.\"O the RE matches the one starting earliest in the string.
.\"O If the RE could match more than one substring starting at that point,
.\"O it matches the longest.
.\"O Subexpressions also match the longest possible substrings, subject to
.\"O the constraint that the whole match be as long as possible,
.\"O with subexpressions starting earlier in the RE taking priority over
.\"O ones starting later.
.\"O Note that higher-level subexpressions thus take priority over
.\"O their lower-level component subexpressions.
正規表現が、与えられた文字列の複数の部分文字列
(substring) にマッチできるような場合には、
最も先頭の近くから始まるものにマッチする。
その位置から始まり、正規表現がマッチできる部分文字列が複数ある場合には、
最長のものにマッチする。
部分正規表現 (subexpression) も最も長い部分文字列にマッチする。
ただし、全体のマッチが最長であるように、という条件が優先される。
正規表現の中で先に現れる部分正規表現は、後に現れるものより優先される。
ただし、より高位の部分正規表現は、
それを構成する低位の部分正規表現よりも優先されることに注意すること。
.PP
.\"O Match lengths are measured in characters, not collating elements.
.\"O A null string is considered longer than no match at all.
.\"O For example,
.\"O "\fIbb*\fP" matches the three middle characters of "abbbc",
.\"O "\fI(wee|week)(knights|nights)\fP"
.\"O matches all ten characters of "weeknights",
.\"O when "\fI(.*).*\fP" is matched against "abc" the parenthesized subexpression
.\"O matches all three characters, and
.\"O when "\fI(a*)*\fP" is matched against "bc"
.\"O both the whole RE and the parenthesized
.\"O subexpression match the null string.
マッチ長は照合順序の要素ではなく、文字数を単位としてカウントされる。
null 文字列は、全くマッチしなかった場合よりも長いとみなされる。
例えば "\fIbb*\fP" は "abbbc" のまん中の 3 文字にマッチする。
"\fI(wee|week)(knights|nights)\fP" は "weeknights" の全体にマッチする。
"\fI(.*).*\fP" を "abc" にマッチさせると、
括弧の内部の部分正規表現が 3 文字すべてにマッチする。
"\fI(a*)*\fP" を "bc" にマッチさせると、正規表現全体も、
括弧で括られた部分正規表現も null 文字列にマッチする。
.PP
.\"O If case-independent matching is specified,
.\"O the effect is much as if all case distinctions had vanished from the
.\"O alphabet.
.\"O When an alphabetic that exists in multiple cases appears as an
.\"O ordinary character outside a bracket expression, it is effectively
.\"O transformed into a bracket expression containing both cases,
.\"O for example, \(aqx\(aq becomes "\fI[xX]\fP".
.\"O When it appears inside a bracket expression, all case counterparts
.\"O of it are added to the bracket expression, so that, for example, "\fI[x]\fP"
.\"O becomes "\fI[xX]\fP" and "\fI[^x]\fP" becomes "\fI[^xX]\fP".
マッチが大文字・小文字を無視するように指定されると、
アルファベット全体から大小文字の区別が無くなったかのような効果となる。
大文字・小文字を持つアルファベットがブラケット表現の外部で
通常の文字として現れると、
これは実効的に大小両方の文字のブラケット表現のように変換される。
すなわち \(aqx\(aq は "\fI[xX]\fP" となる。ブラケット表現の内部に現れると、
大文字なら小文字が、小文字なら大文字がそのブラケット表現に加えられる。
すなわち
"\fI[x]\fP" は "\fI[xX]\fP" に、"\fI[^x]\fP" は "\fI[^xX]\fP" になる。
.PP
.\"O No particular limit is imposed on the length of REs\*(dg.
.\"O Programs intended to be portable should not employ REs longer
.\"O than 256 bytes,
.\"O as an implementation can refuse to accept such REs and remain
.\"O POSIX-compliant.
正規表現の長さには特に制限はない\*(dg。
ただし移植性を高くしたいプログラムでは、
256 バイトより長い正規表現は実行しないようにするほうが良い。
なぜなら、そのような正規表現を拒否し、
しかも POSIX 互換を保つような実装が可能だからである。
.PP
.\"O Obsolete ("basic") regular expressions differ in several respects.
.\"O \(aq|\(aq, \(aq+\(aq, and \(aq?\(aq are
.\"O ordinary characters and there is no equivalent
.\"O for their functionality.
.\"O The delimiters for bounds are "\fI\e{\fP" and "\fI\e}\fP",
.\"O with \(aq{\(aq and \(aq}\(aq by themselves ordinary characters.
.\"O The parentheses for nested subexpressions are "\fI\e(\fP" and "\fI\e)\fP",
.\"O with \(aq(\(aq and \(aq)\(aq by themselves ordinary characters.
.\"O \(aq^\(aq is an ordinary character except at the beginning of the
.\"O RE or\*(dg the beginning of a parenthesized subexpression,
.\"O \(aq$\(aq is an ordinary character except at the end of the
.\"O RE or\*(dg the end of a parenthesized subexpression,
.\"O and \(aq*\(aq is an ordinary character if it appears at the beginning of the
.\"O RE or the beginning of a parenthesized subexpression
.\"O (after a possible leading \(aq^\(aq).
古い ("基本") 正規表現は、いくつかの点において異なる。
\(aq|\(aq, \(aq+\(aq, and \(aq?\(aq は通常の文字となる。
対応する機能は存在しない。繰り返し指定の区切りは
"\fI\e{\fP" および "\fI\e}\fP" となる。\(aq{\(aq と \(aq}\(aq は、
単独では通常の文字として扱われる。
部分正規表現をネストする括弧は "\fI\e(\fP" および "\fI\e)\fP" となり、
\(aq(\(aq と \(aq)\(aq は単独では通常の文字となる。
\(aq^\(aq は正規表現の先頭か、
括弧でくくられた部分表現の先頭\*(dgを除いて通常の文字となる。
\(aq$\(aq は正規表現の末尾か、
括弧でくくられた部分正規表現の末尾\*(dgを除いて通常の文字となる。
\(aq*\(aq は、正規表現の先頭か、
括弧でくくられた部分文字列の先頭に置かれた場合は通常の文字となる
(\(aq^\(aq) が前置されていてもよい)。
.PP
.\"O Finally, there is one new type of atom, a \fIback reference\fR:
.\"O \(aq\e\(aq followed by a nonzero decimal digit \fId\fR
.\"O matches the same sequence of characters
.\"O matched by the \fId\fRth parenthesized subexpression
.\"O (numbering subexpressions by the positions of their opening parentheses,
.\"O left to right),
.\"O so that, for example, "\fI\e([bc]\e)\e1\fP" matches "bb" or "cc" but not "bc".
最後に、アトムとして別のタイプが存在する。
\fI後方参照 (back reference)\fR である。
\(aq\e\(aq の後に 0 でない 10 進数値文字 \fId\fR が続くと、
括弧でくくられた部分正規表現の
\fId\fR 番目にマッチした文字並びと同じものにマッチする。
(部分正規表現の番号付けは、
開き括弧 `(' の位置が左のものから右のものへ向かってなされる。)
したがって "\fI\e([bc]\e)\e1\fP" は
"bb" または "cc" にはマッチするが、"bc" にはマッチしない。
.\"O .SH BUGS
.SH バグ
.\"O Having two kinds of REs is a botch.
正規表現が 2 種類あるのは格好悪い。
.PP
.\"O The current POSIX.2 spec says that \(aq)\(aq is an ordinary character in
.\"O the absence of an unmatched \(aq(\(aq;
.\"O this was an unintentional result of a wording error,
.\"O and change is likely.
.\"O Avoid relying on it.
現在の POSIX.2 規格においては、\(aq)\(aq は、
対応する \(aq(\(aq がない場合には通常の文字として扱われることになっている。
しかしこれは、本来の意図とは異なる記述上のエラーであり、
修正される可能性が高い。これに依存したコードは使わないこと。
.PP
.\"O Back references are a dreadful botch,
.\"O posing major problems for efficient implementations.
.\"O They are also somewhat vaguely defined
.\"O (does
.\"O "\fIa\e(\e(b\e)*\e2\e)*d\fP" match "abbbd"?).
.\"O Avoid using them.
後方参照はひどく出来の悪い代物である。
効率の良い実装をするのはとても難しい。
また定義があいまいである。
("\fIa\e(\e(b\e)*\e2\e)*d\fP" は "abbbd" にマッチすると思うか？)
使わないほうが良い。
.PP
.\"O POSIX.2's specification of case-independent matching is vague.
.\"O The "one case implies all cases" definition given above
.\"O is current consensus among implementors as to the right interpretation.
POSIX.2 の規格では、case (大文字か小文字か)
に依存しないマッチの記述があいまいである。
現在のところでは「一つの case がすべての case を意味する」
という上記の定義が正しい解釈であるというのが、
実装者の間での共通認識のようである。
.\" As per http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=295666
.\" The following does not seem to apply in the glibc implementation
.\" .PP
.\"O .\" The syntax for word boundaries is incredibly ugly.
.\" ワード境界に関する文法定義が非常に醜い。
.\"O .SH AUTHOR
.SH 著者
.\" Sigh... The page license means we must have the author's name
.\" in the formatted output.
.\"O This page was taken from Henry Spencer's regex package.
このページは Henry Spencer の regex パッケージから採録したものである。
.\"O .SH SEE ALSO
.SH 関連項目
.BR grep (1),
.BR regex (3)
.PP
POSIX.2, section 2.8 (Regular Expression Notation).
